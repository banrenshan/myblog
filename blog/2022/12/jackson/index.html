<!doctype html><html class=position-relative itemscope itemtype=https://schema.org/WebPage lang=zh-hans data-bs-theme=auto data-palette=purple><head><script src=/myblog/assets/init/bundle.min.28cde6c3afc388a3d86d2a990679f9c3f5cb038fc7596a13ea18a4a0ed45c5f0.js integrity="sha256-KM3mw6/DiKPYbSqZBnn5w/XLA4/HWWoT6hikoO1FxfA=" crossorigin=anonymous></script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>jackson -</title><link rel=icon href=/myblog/favicon_hucccd9e706a19cc8586335b155a80c266_43860_16x16_resize_q75_h2_box_2.webp sizes=16x16 type=image/webp><link rel=icon href=/myblog/favicon_hucccd9e706a19cc8586335b155a80c266_43860_32x32_resize_q75_h2_box_2.webp sizes=32x32 type=image/webp><link rel=icon href=/myblog/favicon_hucccd9e706a19cc8586335b155a80c266_43860_150x150_resize_q75_h2_box_2.webp sizes=150x150 type=image/webp><link rel=apple-touch-icon href=/myblog/favicon_hucccd9e706a19cc8586335b155a80c266_43860_180x180_resize_q75_h2_box_2.webp sizes=180x180 type=image/webp><link rel=icon href=/myblog/favicon_hucccd9e706a19cc8586335b155a80c266_43860_192x192_resize_q75_h2_box_2.webp sizes=192x192 type=image/webp><link rel=mask-icon href=/myblog/safari-pinned-tab.svg color=#6f42c1><meta name=keywords content="Hugo,Bootstrap,Blog Theme"><meta name=description content="ObjectMapper 基本使用 public class Car { private String color; private String type; // standard getters setters } 序列化:
ObjectMapper objectMapper = new ObjectMapper(); Car car = new Car(&#34;yellow&#34;, &#34;renault&#34;); objectMapper.writeValue(new File(&#34;target/car.json&#34;), car); {&#34;color&#34;:&#34;yellow&#34;,&#34;type&#34;:&#34;renault&#34;} ObjectMapper类的writeValueAsString和writeValueAsBytes方法从Java对象生成JSON，并将生成的JSON作为字符串或字节数组返回：
String carAsString = objectMapper.writeValueAsString(car); 反序列化：
String json = &#34;{ \&#34;color\&#34; : \&#34;Black\&#34;, \&#34;type\&#34; : \&#34;BMW\&#34; }&#34;; Car car = objectMapper.readValue(json, Car.class);	readValue函数还接受其他形式的输入，例如包含JSON字符串的文件：
Car car = objectMapper.readValue(new File(&#34;src/test/resources/json_car.json&#34;), Car.class); 或者从URL中：
Car car = objectMapper.readValue(new URL(&#34;file:src/test/resources/json_car.json&#34;), Car.class); JsonNode：json的表示对象 或者，可以将JSON解析为JsonNode对象，并用于从特定节点检索数据："><meta name=twitter:card content="summary"><meta name=twitter:title content="jackson"><meta name=twitter:description content="ObjectMapper 基本使用 public class Car { private String color; private String type; // standard getters setters } 序列化:
ObjectMapper objectMapper = new ObjectMapper(); Car car = new Car(&#34;yellow&#34;, &#34;renault&#34;); objectMapper.writeValue(new File(&#34;target/car.json&#34;), car); {&#34;color&#34;:&#34;yellow&#34;,&#34;type&#34;:&#34;renault&#34;} ObjectMapper类的writeValueAsString和writeValueAsBytes方法从Java对象生成JSON，并将生成的JSON作为字符串或字节数组返回：
String carAsString = objectMapper.writeValueAsString(car); 反序列化：
String json = &#34;{ \&#34;color\&#34; : \&#34;Black\&#34;, \&#34;type\&#34; : \&#34;BMW\&#34; }&#34;; Car car = objectMapper.readValue(json, Car.class);	readValue函数还接受其他形式的输入，例如包含JSON字符串的文件：
Car car = objectMapper.readValue(new File(&#34;src/test/resources/json_car.json&#34;), Car.class); 或者从URL中：
Car car = objectMapper.readValue(new URL(&#34;file:src/test/resources/json_car.json&#34;), Car.class); JsonNode：json的表示对象 或者，可以将JSON解析为JsonNode对象，并用于从特定节点检索数据："><meta property="og:title" content="jackson"><meta property="og:description" content="ObjectMapper 基本使用 public class Car { private String color; private String type; // standard getters setters } 序列化:
ObjectMapper objectMapper = new ObjectMapper(); Car car = new Car(&#34;yellow&#34;, &#34;renault&#34;); objectMapper.writeValue(new File(&#34;target/car.json&#34;), car); {&#34;color&#34;:&#34;yellow&#34;,&#34;type&#34;:&#34;renault&#34;} ObjectMapper类的writeValueAsString和writeValueAsBytes方法从Java对象生成JSON，并将生成的JSON作为字符串或字节数组返回：
String carAsString = objectMapper.writeValueAsString(car); 反序列化：
String json = &#34;{ \&#34;color\&#34; : \&#34;Black\&#34;, \&#34;type\&#34; : \&#34;BMW\&#34; }&#34;; Car car = objectMapper.readValue(json, Car.class);	readValue函数还接受其他形式的输入，例如包含JSON字符串的文件：
Car car = objectMapper.readValue(new File(&#34;src/test/resources/json_car.json&#34;), Car.class); 或者从URL中：
Car car = objectMapper.readValue(new URL(&#34;file:src/test/resources/json_car.json&#34;), Car.class); JsonNode：json的表示对象 或者，可以将JSON解析为JsonNode对象，并用于从特定节点检索数据："><meta property="og:type" content="article"><meta property="og:url" content="https://banrenshan.github.io/myblog/blog/2022/12/jackson/"><meta property="article:section" content="blog"><meta property="article:published_time" content="2022-12-02T12:41:07+00:00"><meta property="article:modified_time" content="2023-10-07T19:19:27+08:00"><meta itemprop=name content="jackson"><meta itemprop=description content="ObjectMapper 基本使用 public class Car { private String color; private String type; // standard getters setters } 序列化:
ObjectMapper objectMapper = new ObjectMapper(); Car car = new Car(&#34;yellow&#34;, &#34;renault&#34;); objectMapper.writeValue(new File(&#34;target/car.json&#34;), car); {&#34;color&#34;:&#34;yellow&#34;,&#34;type&#34;:&#34;renault&#34;} ObjectMapper类的writeValueAsString和writeValueAsBytes方法从Java对象生成JSON，并将生成的JSON作为字符串或字节数组返回：
String carAsString = objectMapper.writeValueAsString(car); 反序列化：
String json = &#34;{ \&#34;color\&#34; : \&#34;Black\&#34;, \&#34;type\&#34; : \&#34;BMW\&#34; }&#34;; Car car = objectMapper.readValue(json, Car.class);	readValue函数还接受其他形式的输入，例如包含JSON字符串的文件：
Car car = objectMapper.readValue(new File(&#34;src/test/resources/json_car.json&#34;), Car.class); 或者从URL中：
Car car = objectMapper.readValue(new URL(&#34;file:src/test/resources/json_car.json&#34;), Car.class); JsonNode：json的表示对象 或者，可以将JSON解析为JsonNode对象，并用于从特定节点检索数据："><meta itemprop=datePublished content="2022-12-02T12:41:07+00:00"><meta itemprop=dateModified content="2023-10-07T19:19:27+08:00"><meta itemprop=wordCount content="2884"><meta itemprop=keywords content="java,"><meta property="og:image" content="https://banrenshan.github.io/myblog/images/logo.png"><meta name=twitter:image content="https://banrenshan.github.io/myblog/images/logo.png"><meta property="og:image:alt" content="jackson"><meta name=twitter:image:alt content="jackson"><link rel=manifest href=/myblog/manifest.json><link data-precache rel=stylesheet href="/myblog/assets/main/bundle.min.906e48a4015f207e7ad2852421d4b8e6fda8fb5c6d1fff31855591474e60da12.css" integrity="sha256-kG5IpAFfIH560oUkIdS45v2o+1xtH/8xhVWRR05g2hI=" crossorigin=anonymous><link data-precache rel=stylesheet href=/myblog/assets/viewer/bundle.min.eb914844636cd41f221f109e99c887bbc3b6b5ffb2af7c664b284cea2d1b54b7.css integrity="sha256-65FIRGNs1B8iHxCemciHu8O2tf+yr3xmSyhM6i0bVLc=" crossorigin=anonymous></head><body><header class="mb-4 sticky-top"><nav class="top-app-bar shadow navbar navbar-expand-xxl"><div class=container><a class="navbar-brand d-flex align-items-center flex-grow-1 flex-xxl-grow-0 justify-content-xxl-start ms-2 ms-xxl-0 mx-auto me-xxl-2" href=https://banrenshan.github.io/myblog/><picture><img class=logo alt=Logo src=https://banrenshan.github.io/myblog/images/logo.webp loading=lazy width=400 height=400></picture></a><div class="offcanvas-xxl offcanvas-end flex-grow-1" data-bs-scroll=true tabindex=-1 id=navbarMenus aria-labelledby=navbarMenusLabel><div class="offcanvas-header px-4 pb-0"><div class="offcanvas-title h5" id=navbarMenusLabel></div><button type=button class="btn-close btn-close-white" data-bs-dismiss=offcanvas data-bs-target=#navbarMenus aria-label=Close></button></div><div class="offcanvas-body p-4 pt-0 p-xxl-0"><hr class=d-xxl-none><ul class="navbar-nav flex-row flex-wrap align-items-center me-auto"><li class="nav-item col-6 col-xxl-auto"><a class="nav-link py-2 px-0 px-xxl-2" href=https://banrenshan.github.io/myblog/docs/><span class="menu-icon me-1"><i class="fas fa-fw fa-book"></i></span>文档</a></li><li class="nav-item col-6 col-xxl-auto"><a class="nav-link py-2 px-0 px-xxl-2" href=https://banrenshan.github.io/myblog/series/><span class="menu-icon me-1"><i class="fas fa-fw fa-columns"></i></span>专栏</a></li><li class="nav-item col-6 col-xxl-auto"><a class="nav-link py-2 px-0 px-xxl-2" href=https://banrenshan.github.io/myblog/categories/><span class="menu-icon me-1"><i class="fas fa-fw fa-folder"></i></span>分类</a></li><li class="nav-item col-6 col-xxl-auto"><a class="nav-link py-2 px-0 px-xxl-2" href=https://banrenshan.github.io/myblog/archives/><span class="menu-icon me-1"><i class="fas fa-fw fa-file-archive"></i></span>归档</a></li><li class="nav-item col-6 col-xxl-auto"><a class="nav-link py-2 px-0 px-xxl-2" href=https://banrenshan.github.io/myblog/tags/><span class="menu-icon me-1"><i class="fas fa-fw fa-tags"></i></span>标签</a></li></ul><hr class=d-xxl-none><form class="search-bar ms-auto my-auto" action=/myblog/search/ novalidate><div class="input-group input-group-sm align-items-center"><span class="btn btn-search disabled position-absolute left-0 border-0 px-1"><i class="fas fa-fw fa-search fa-lg"></i></span>
<input class="my-1 form-control border-white rounded-5 search-input bg-body" name=q type=search placeholder=搜索 aria-label=Search required>
<span class="search-shortcut position-absolute end-0 top-0 me-2"><kbd class="bg-primary rounded shadow">/</kbd></span></div></form><hr class=d-xxl-none><ul class="navbar-nav flex-row flex-wrap align-items-center ms-md-auto"><li class="nav-item dropdown col-6 col-xxl-auto"><a class="nav-link px-0 py-2 px-xxl-1" href=# id=fontSizeDropdown role=button data-bs-toggle=dropdown aria-expanded=false><i class="fas fa-fw fa-font"></i>
<span class=d-xxl-none>字体大小</span></a><ul class="font-size-dropdown-menu dropdown-menu dropdown-menu-end" aria-labelledby=fontSizeDropdown><li><button class="font-size-item dropdown-item" data-size=xs>
特小号</button></li><li><button class="font-size-item dropdown-item" data-size=sm>
小号</button></li><li><button class="font-size-item dropdown-item active" data-size=md>
中等</button></li><li><button class="font-size-item dropdown-item" data-size=lg>
大号</button></li><li><button class="font-size-item dropdown-item" data-size=xl>
特大号</button></li></ul></li><li class="nav-item dropdown col-6 col-xxl-auto"><a class="nav-link px-0 py-2 px-xxl-1" href=# id=paletteDropdown role=button data-bs-toggle=dropdown aria-expanded=false><i class="fas fa-fw fa-palette"></i>
<span class=d-xxl-none>配色</span></a><ul class="palette-dropdown-menu dropdown-menu dropdown-menu-end px-2 row g-2" aria-labelledby=paletteDropdown><li class="col-4 my-1"><a role=button id=palette-blue aria-label=蓝色 class="btn btn-sm w-100 palette text-bg-blue" data-palette=blue></a></li><li class="col-4 my-1"><a role=button id=palette-blue-gray aria-label=蓝灰色 class="btn btn-sm w-100 palette text-bg-blue-gray" data-palette=blue-gray></a></li><li class="col-4 my-1"><a role=button id=palette-brown aria-label=棕色 class="btn btn-sm w-100 palette text-bg-brown" data-palette=brown></a></li><li class="col-4 my-1"><a role=button id=palette-cyan aria-label=青色 class="btn btn-sm w-100 palette text-bg-cyan" data-palette=cyan></a></li><li class="col-4 my-1"><a role=button id=palette-green aria-label=绿色 class="btn btn-sm w-100 palette text-bg-green" data-palette=green></a></li><li class="col-4 my-1"><a role=button id=palette-indigo aria-label=靛青色 class="btn btn-sm w-100 palette text-bg-indigo" data-palette=indigo></a></li><li class="col-4 my-1"><a role=button id=palette-orange aria-label=橙色 class="btn btn-sm w-100 palette text-bg-orange" data-palette=orange></a></li><li class="col-4 my-1"><a role=button id=palette-pink aria-label=粉色 class="btn btn-sm w-100 palette text-bg-pink" data-palette=pink></a></li><li class="col-4 my-1"><a role=button id=palette-purple aria-label=紫色 class="btn btn-sm w-100 palette text-bg-purple" data-palette=purple></a></li><li class="col-4 my-1"><a role=button id=palette-red aria-label=红色 class="btn btn-sm w-100 palette text-bg-red" data-palette=red></a></li><li class="col-4 my-1"><a role=button id=palette-teal aria-label=蓝绿色 class="btn btn-sm w-100 palette text-bg-teal" data-palette=teal></a></li><li class="col-4 my-1"><a role=button id=palette-yellow aria-label=黄色 class="btn btn-sm w-100 palette text-bg-yellow" data-palette=yellow></a></li></ul></li><li class="nav-item dropdown col-6 col-xxl-auto"><a class="nav-link px-0 py-2 px-xxl-1" href=# id=modeDropdown role=button data-bs-toggle=dropdown aria-expanded=false><i class="mode-icon fas fa-fw fa-adjust" id=modeIcon></i>
<span class=d-xxl-none>模式</span></a><ul class="mode-dropdown-menu dropdown-menu dropdown-menu-end" aria-labelledby=modeDropdown><li class=mode-item data-color-mode=light data-icon=sun><button class=dropdown-item>
<i class="mode-icon fas fa-fw fa-sun"></i> 浅色</button></li><li class=mode-item data-color-mode=dark data-icon=moon><button class=dropdown-item>
<i class="mode-icon fas fa-fw fa-moon"></i> 深色</button></li><li class="mode-item active" data-color-mode=auto data-icon=adjust><button class=dropdown-item>
<i class="mode-icon fas fa-fw fa-adjust"></i> 自动</button></li></ul></li></ul></div></div><div class=d-flex><button class="navbar-toggler order-5 border-0" type=button data-bs-toggle=offcanvas data-bs-target=#navbarMenus aria-controls=navbarMenus aria-expanded=false aria-label="Toggle navigation">
<i class="fas fa-ellipsis-h"></i></button></div></div></nav></header><main class=container><div class="row content"><noscript><div class="alert alert-danger" role=alert>你的浏览器不支持 JavaScript。</div></noscript><div class=col-xxl-8><div class=container><nav class="row card component" aria-label=breadcrumb><div class="card-body pb-0"><ol class="hbs-breadcrumb breadcrumb flex-nowrap"><li class="breadcrumb-item text-surface"><a href=/myblog/>主页</a></li><li class="breadcrumb-item text-surface"><a href=/myblog/blog/>Blogs</a></li><li class="breadcrumb-item active">Jackson</li></ol></div></nav><div class="post-panel-wrapper position-relative d-flex justify-content-center"><div class="d-flex flex-row justify-content-center rounded-5 border post-panel position-fixed px-3 py-1 surface shadow-1"><a class="action action-toc d-none d-xxl-block" href=#postTOC role=button title="Table of contents"><i class="fas fa-fw fa-list-alt"></i></a>
<a class="action action-toc d-block d-xxl-none" href=#post-toc-container role=button title="Table of contents"><i class="fas fa-fw fa-list-alt"></i></a>
<a class="action action-post-comments" href=#post-comments role=button aria-label=Comments title=Comments><i class="fas fa-fw fa-comments"></i></a>
<a id=sidebarToggler class="action action-sidebar-toggler d-none d-xxl-block" role=button title="Sidebar toggler"><i class="fas fa-fw fa-expand-alt" data-fa-transform=rotate-45></i></a></div></div><article class="row card component mb-4 post"><div class=card-header><h1 class="card-title post-title my-2">Jackson</h1></div><div class=card-body><div class="post-meta mb-3"><span class="post-date me-1 mb-1" title="创建于 2022-12-02 12:41:07 +0000 UTC，更新于 2023-10-07 11:19:27 +0000 UTC。">2022年12月2日</span><span class="post-reading-time me-1 mb-1">14 分钟阅读</span><a href=/myblog/categories/%E6%8A%80%E6%9C%AF/ class="btn btn-sm btn-secondary mb-1 me-2 py-0 pe-1 post-taxonomy post-taxonomy-sm post-category">
<i class="fas fa-fw fa-folder me-1"></i>技术</a><a href=/myblog/tags/java/ class="btn btn-sm btn-secondary mb-1 me-2 py-0 pe-1 post-taxonomy post-taxonomy-sm post-tag">Java</a></div><div class="mt-2 mb-3 d-block d-xxl-none"><h2 class="text-surface mb-3">目录</h2><div id=post-toc-container></div><hr class=text-secondary></div><div class="post-content mb-3" data-bs-spy=scroll data-bs-target=#TableOfContents tabindex=0><div id=post-content-body><h1 id=objectmapper data-numberify>ObjectMapper<a class="anchor ms-1" href=#objectmapper></a></h1><h2 id=基本使用 data-numberify>基本使用<a class="anchor ms-1" href=#基本使用></a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Car</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>color</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>type</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// standard getters setters
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span></code></pre></div><p><strong>序列化:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>ObjectMapper</span> <span class=n>objectMapper</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectMapper</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=n>Car</span> <span class=n>car</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Car</span><span class=o>(</span><span class=s>&#34;yellow&#34;</span><span class=o>,</span> <span class=s>&#34;renault&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>objectMapper</span><span class=o>.</span><span class=na>writeValue</span><span class=o>(</span><span class=k>new</span> <span class=n>File</span><span class=o>(</span><span class=s>&#34;target/car.json&#34;</span><span class=o>),</span> <span class=n>car</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>{</span><span class=s>&#34;color&#34;</span><span class=o>:</span><span class=s>&#34;yellow&#34;</span><span class=o>,</span><span class=s>&#34;type&#34;</span><span class=o>:</span><span class=s>&#34;renault&#34;</span><span class=o>}</span>
</span></span></code></pre></div><p>ObjectMapper类的writeValueAsString和writeValueAsBytes方法从Java对象生成JSON，并将生成的JSON作为字符串或字节数组返回：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>String</span> <span class=n>carAsString</span> <span class=o>=</span> <span class=n>objectMapper</span><span class=o>.</span><span class=na>writeValueAsString</span><span class=o>(</span><span class=n>car</span><span class=o>);</span>
</span></span></code></pre></div><p>反序列化：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>String</span> <span class=n>json</span> <span class=o>=</span> <span class=s>&#34;{ \&#34;color\&#34; : \&#34;Black\&#34;, \&#34;type\&#34; : \&#34;BMW\&#34; }&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=n>Car</span> <span class=n>car</span> <span class=o>=</span> <span class=n>objectMapper</span><span class=o>.</span><span class=na>readValue</span><span class=o>(</span><span class=n>json</span><span class=o>,</span> <span class=n>Car</span><span class=o>.</span><span class=na>class</span><span class=o>);</span>	
</span></span></code></pre></div><p>readValue函数还接受其他形式的输入，例如包含JSON字符串的文件：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Car</span> <span class=n>car</span> <span class=o>=</span> <span class=n>objectMapper</span><span class=o>.</span><span class=na>readValue</span><span class=o>(</span><span class=k>new</span> <span class=n>File</span><span class=o>(</span><span class=s>&#34;src/test/resources/json_car.json&#34;</span><span class=o>),</span> <span class=n>Car</span><span class=o>.</span><span class=na>class</span><span class=o>);</span>
</span></span></code></pre></div><p>或者从URL中：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Car</span> <span class=n>car</span> <span class=o>=</span> 
</span></span><span class=line><span class=cl>  <span class=n>objectMapper</span><span class=o>.</span><span class=na>readValue</span><span class=o>(</span><span class=k>new</span> <span class=n>URL</span><span class=o>(</span><span class=s>&#34;file:src/test/resources/json_car.json&#34;</span><span class=o>),</span> <span class=n>Car</span><span class=o>.</span><span class=na>class</span><span class=o>);</span>
</span></span></code></pre></div><h2 id=jsonnodejson的表示对象 data-numberify>JsonNode：json的表示对象<a class="anchor ms-1" href=#jsonnodejson的表示对象></a></h2><p>或者，可以将JSON解析为JsonNode对象，并用于从特定节点检索数据：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>String</span> <span class=n>json</span> <span class=o>=</span> <span class=s>&#34;{ \&#34;color\&#34; : \&#34;Black\&#34;, \&#34;type\&#34; : \&#34;FIAT\&#34; }&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=n>JsonNode</span> <span class=n>jsonNode</span> <span class=o>=</span> <span class=n>objectMapper</span><span class=o>.</span><span class=na>readTree</span><span class=o>(</span><span class=n>json</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>String</span> <span class=n>color</span> <span class=o>=</span> <span class=n>jsonNode</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=s>&#34;color&#34;</span><span class=o>).</span><span class=na>asText</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=c1>// Output: color -&gt; Black
</span></span></span></code></pre></div><p>更低层次的转换：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Test</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>givenUsingLowLevelApi_whenParsingJsonStringIntoJsonNode_thenCorrect</span><span class=o>()</span> 
</span></span><span class=line><span class=cl>  <span class=kd>throws</span> <span class=n>JsonParseException</span><span class=o>,</span> <span class=n>IOException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>jsonString</span> <span class=o>=</span> <span class=s>&#34;{&#34;</span><span class=n>k1</span><span class=s>&#34;:&#34;</span><span class=n>v1</span><span class=s>&#34;,&#34;</span><span class=n>k2</span><span class=s>&#34;:&#34;</span><span class=n>v2</span><span class=s>&#34;}&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>ObjectMapper</span> <span class=n>mapper</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectMapper</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=n>JsonFactory</span> <span class=n>factory</span> <span class=o>=</span> <span class=n>mapper</span><span class=o>.</span><span class=na>getFactory</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=n>JsonParser</span> <span class=n>parser</span> <span class=o>=</span> <span class=n>factory</span><span class=o>.</span><span class=na>createParser</span><span class=o>(</span><span class=n>jsonString</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>JsonNode</span> <span class=n>actualObj</span> <span class=o>=</span> <span class=n>mapper</span><span class=o>.</span><span class=na>readTree</span><span class=o>(</span><span class=n>parser</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>assertNotNull</span><span class=o>(</span><span class=n>actualObj</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h2 id=转换成集合类型 data-numberify>转换成集合类型<a class="anchor ms-1" href=#转换成集合类型></a></h2><p>我们可以使用TypeReference将数组形式的JSON解析为Java对象列表：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>String</span> <span class=n>jsonCarArray</span> <span class=o>=</span> 
</span></span><span class=line><span class=cl>  <span class=s>&#34;[{ \&#34;color\&#34; : \&#34;Black\&#34;, \&#34;type\&#34; : \&#34;BMW\&#34; }, { \&#34;color\&#34; : \&#34;Red\&#34;, \&#34;type\&#34; : \&#34;FIAT\&#34; }]&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=n>List</span><span class=o>&lt;</span><span class=n>Car</span><span class=o>&gt;</span> <span class=n>listCar</span> <span class=o>=</span> <span class=n>objectMapper</span><span class=o>.</span><span class=na>readValue</span><span class=o>(</span><span class=n>jsonCarArray</span><span class=o>,</span> <span class=k>new</span> <span class=n>TypeReference</span><span class=o>&lt;</span><span class=n>List</span><span class=o>&lt;</span><span class=n>Car</span><span class=o>&gt;&gt;(){});</span>
</span></span><span class=line><span class=cl><span class=n>String</span> <span class=n>jsonCarArray</span> <span class=o>=</span> 
</span></span><span class=line><span class=cl>  <span class=s>&#34;[{ \&#34;color\&#34; : \&#34;Black\&#34;, \&#34;type\&#34; : \&#34;BMW\&#34; }, { \&#34;color\&#34; : \&#34;Red\&#34;, \&#34;type\&#34; : \&#34;FIAT\&#34; }]&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=n>ObjectMapper</span> <span class=n>objectMapper</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectMapper</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=n>objectMapper</span><span class=o>.</span><span class=na>configure</span><span class=o>(</span><span class=n>DeserializationFeature</span><span class=o>.</span><span class=na>USE_JAVA_ARRAY_FOR_JSON_ARRAY</span><span class=o>,</span> <span class=kc>true</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>Car</span><span class=o>[]</span> <span class=n>cars</span> <span class=o>=</span> <span class=n>objectMapper</span><span class=o>.</span><span class=na>readValue</span><span class=o>(</span><span class=n>jsonCarArray</span><span class=o>,</span> <span class=n>Car</span><span class=o>[].</span><span class=na>class</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=c1>// print cars
</span></span></span></code></pre></div><p>类似地，我们可以将JSON解析为Java Map：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>String</span> <span class=n>json</span> <span class=o>=</span> <span class=s>&#34;{ \&#34;color\&#34; : \&#34;Black\&#34;, \&#34;type\&#34; : \&#34;BMW\&#34; }&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=n>Map</span><span class=o>&lt;</span><span class=n>String</span><span class=o>,</span> <span class=n>Object</span><span class=o>&gt;</span> <span class=n>map</span> 
</span></span><span class=line><span class=cl>  <span class=o>=</span> <span class=n>objectMapper</span><span class=o>.</span><span class=na>readValue</span><span class=o>(</span><span class=n>json</span><span class=o>,</span> <span class=k>new</span> <span class=n>TypeReference</span><span class=o>&lt;</span><span class=n>Map</span><span class=o>&lt;</span><span class=n>String</span><span class=o>,</span><span class=n>Object</span><span class=o>&gt;&gt;(){});</span>
</span></span></code></pre></div><h1 id=注解 data-numberify>注解<a class="anchor ms-1" href=#注解></a></h1><h2 id=常规注解 data-numberify>常规注解<a class="anchor ms-1" href=#常规注解></a></h2><h3 id=jsonproperty data-numberify>@JsonProperty<a class="anchor ms-1" href=#jsonproperty></a></h3><p>我们可以添加@JsonProperty注释，表示JSON中的属性名称。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>MyBean</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@JsonProperty</span><span class=o>(</span><span class=s>&#34;name&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>setTheName</span><span class=o>(</span><span class=n>String</span> <span class=n>name</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>name</span> <span class=o>=</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@JsonProperty</span><span class=o>(</span><span class=s>&#34;name&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=nf>getTheName</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=nd>@Test</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>whenUsingJsonProperty_thenCorrect</span><span class=o>()</span>
</span></span><span class=line><span class=cl>  <span class=kd>throws</span> <span class=n>IOException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>MyBean</span> <span class=n>bean</span> <span class=o>=</span> <span class=k>new</span> <span class=n>MyBean</span><span class=o>(</span><span class=mi>1</span><span class=o>,</span> <span class=s>&#34;My bean&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>result</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectMapper</span><span class=o>().</span><span class=na>writeValueAsString</span><span class=o>(</span><span class=n>bean</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>assertThat</span><span class=o>(</span><span class=n>result</span><span class=o>,</span> <span class=n>containsString</span><span class=o>(</span><span class=s>&#34;My bean&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>assertThat</span><span class=o>(</span><span class=n>result</span><span class=o>,</span> <span class=n>containsString</span><span class=o>(</span><span class=s>&#34;1&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>MyBean</span> <span class=n>resultBean</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectMapper</span><span class=o>()</span>
</span></span><span class=line><span class=cl>      <span class=o>.</span><span class=na>readerFor</span><span class=o>(</span><span class=n>MyBean</span><span class=o>.</span><span class=na>class</span><span class=o>)</span>
</span></span><span class=line><span class=cl>      <span class=o>.</span><span class=na>readValue</span><span class=o>(</span><span class=n>result</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>assertEquals</span><span class=o>(</span><span class=s>&#34;My bean&#34;</span><span class=o>,</span> <span class=n>resultBean</span><span class=o>.</span><span class=na>getTheName</span><span class=o>());</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h3 id=jsonformat data-numberify>@JsonFormat<a class="anchor ms-1" href=#jsonformat></a></h3><p>@JsonFormat注释指定序列化日期/时间值时的格式。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>EventWithFormat</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@JsonFormat</span><span class=o>(</span>
</span></span><span class=line><span class=cl>      <span class=n>shape</span> <span class=o>=</span> <span class=n>JsonFormat</span><span class=o>.</span><span class=na>Shape</span><span class=o>.</span><span class=na>STRING</span><span class=o>,</span>
</span></span><span class=line><span class=cl>      <span class=n>pattern</span> <span class=o>=</span> <span class=s>&#34;dd-MM-yyyy hh:mm:ss&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>Date</span> <span class=n>eventDate</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=nd>@Test</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>whenSerializingUsingJsonFormat_thenCorrect</span><span class=o>()</span>
</span></span><span class=line><span class=cl>  <span class=kd>throws</span> <span class=n>JsonProcessingException</span><span class=o>,</span> <span class=n>ParseException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>SimpleDateFormat</span> <span class=n>df</span> <span class=o>=</span> <span class=k>new</span> <span class=n>SimpleDateFormat</span><span class=o>(</span><span class=s>&#34;dd-MM-yyyy hh:mm:ss&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>df</span><span class=o>.</span><span class=na>setTimeZone</span><span class=o>(</span><span class=n>TimeZone</span><span class=o>.</span><span class=na>getTimeZone</span><span class=o>(</span><span class=s>&#34;UTC&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>toParse</span> <span class=o>=</span> <span class=s>&#34;20-12-2014 02:30:00&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=n>Date</span> <span class=n>date</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=na>parse</span><span class=o>(</span><span class=n>toParse</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>EventWithFormat</span> <span class=n>event</span> <span class=o>=</span> <span class=k>new</span> <span class=n>EventWithFormat</span><span class=o>(</span><span class=s>&#34;party&#34;</span><span class=o>,</span> <span class=n>date</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>result</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectMapper</span><span class=o>().</span><span class=na>writeValueAsString</span><span class=o>(</span><span class=n>event</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>assertThat</span><span class=o>(</span><span class=n>result</span><span class=o>,</span> <span class=n>containsString</span><span class=o>(</span><span class=n>toParse</span><span class=o>));</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h3 id=jsonunwrapped data-numberify>@JsonUnwrapped<a class="anchor ms-1" href=#jsonunwrapped></a></h3><p>@JsonUnwrapped定义了序列化/反序列化时应展开/展平的值。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>UnwrappedUser</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@JsonUnwrapped</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>Name</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kd>class</span> <span class=nc>Name</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>public</span> <span class=n>String</span> <span class=n>firstName</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=kd>public</span> <span class=n>String</span> <span class=n>lastName</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=nd>@Test</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>whenSerializingUsingJsonUnwrapped_thenCorrect</span><span class=o>()</span>
</span></span><span class=line><span class=cl>  <span class=kd>throws</span> <span class=n>JsonProcessingException</span><span class=o>,</span> <span class=n>ParseException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>UnwrappedUser</span><span class=o>.</span><span class=na>Name</span> <span class=n>name</span> <span class=o>=</span> <span class=k>new</span> <span class=n>UnwrappedUser</span><span class=o>.</span><span class=na>Name</span><span class=o>(</span><span class=s>&#34;John&#34;</span><span class=o>,</span> <span class=s>&#34;Doe&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>UnwrappedUser</span> <span class=n>user</span> <span class=o>=</span> <span class=k>new</span> <span class=n>UnwrappedUser</span><span class=o>(</span><span class=mi>1</span><span class=o>,</span> <span class=n>name</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>result</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectMapper</span><span class=o>().</span><span class=na>writeValueAsString</span><span class=o>(</span><span class=n>user</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>assertThat</span><span class=o>(</span><span class=n>result</span><span class=o>,</span> <span class=n>containsString</span><span class=o>(</span><span class=s>&#34;John&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>assertThat</span><span class=o>(</span><span class=n>result</span><span class=o>,</span> <span class=n>not</span><span class=o>(</span><span class=n>containsString</span><span class=o>(</span><span class=s>&#34;name&#34;</span><span class=o>)));</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;id&#34;</span><span class=o>:</span><span class=mi>1</span><span class=o>,</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;firstName&#34;</span><span class=o>:</span><span class=s>&#34;John&#34;</span><span class=o>,</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;lastName&#34;</span><span class=o>:</span><span class=s>&#34;Doe&#34;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h3 id=jsonview data-numberify>@JsonView<a class="anchor ms-1" href=#jsonview></a></h3><p>@JsonView指示将在其中包含属性以进行序列化/反序列化的视图。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Views</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kd>class</span> <span class=nc>Public</span> <span class=o>{}</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kd>class</span> <span class=nc>Internal</span> <span class=kd>extends</span> <span class=n>Public</span> <span class=o>{}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Item</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=nd>@JsonView</span><span class=o>(</span><span class=n>Views</span><span class=o>.</span><span class=na>Public</span><span class=o>.</span><span class=na>class</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@JsonView</span><span class=o>(</span><span class=n>Views</span><span class=o>.</span><span class=na>Public</span><span class=o>.</span><span class=na>class</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=n>itemName</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@JsonView</span><span class=o>(</span><span class=n>Views</span><span class=o>.</span><span class=na>Internal</span><span class=o>.</span><span class=na>class</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=n>ownerName</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=nd>@Test</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>whenSerializingUsingJsonView_thenCorrect</span><span class=o>()</span>
</span></span><span class=line><span class=cl>  <span class=kd>throws</span> <span class=n>JsonProcessingException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Item</span> <span class=n>item</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Item</span><span class=o>(</span><span class=mi>2</span><span class=o>,</span> <span class=s>&#34;book&#34;</span><span class=o>,</span> <span class=s>&#34;John&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>result</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectMapper</span><span class=o>()</span>
</span></span><span class=line><span class=cl>      <span class=o>.</span><span class=na>writerWithView</span><span class=o>(</span><span class=n>Views</span><span class=o>.</span><span class=na>Public</span><span class=o>.</span><span class=na>class</span><span class=o>)</span>
</span></span><span class=line><span class=cl>      <span class=o>.</span><span class=na>writeValueAsString</span><span class=o>(</span><span class=n>item</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>assertThat</span><span class=o>(</span><span class=n>result</span><span class=o>,</span> <span class=n>containsString</span><span class=o>(</span><span class=s>&#34;book&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>assertThat</span><span class=o>(</span><span class=n>result</span><span class=o>,</span> <span class=n>containsString</span><span class=o>(</span><span class=s>&#34;2&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>assertThat</span><span class=o>(</span><span class=n>result</span><span class=o>,</span> <span class=n>not</span><span class=o>(</span><span class=n>containsString</span><span class=o>(</span><span class=s>&#34;John&#34;</span><span class=o>)));</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h3 id=jsonmanagedreference-jsonbackreference data-numberify>@JsonManagedReference, @JsonBackReference<a class="anchor ms-1" href=#jsonmanagedreference-jsonbackreference></a></h3><p>@JsonManagedReference和@JsonBackReference注释可以处理父/子关系并处理循环依赖。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>ItemWithRef</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=n>itemName</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@JsonManagedReference</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>UserWithRef</span> <span class=n>owner</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>UserWithRef</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@JsonBackReference</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>List</span><span class=o>&lt;</span><span class=n>ItemWithRef</span><span class=o>&gt;</span> <span class=n>userItems</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=nd>@Test</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>whenSerializingUsingJacksonReferenceAnnotation_thenCorrect</span><span class=o>()</span>
</span></span><span class=line><span class=cl>  <span class=kd>throws</span> <span class=n>JsonProcessingException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>UserWithRef</span> <span class=n>user</span> <span class=o>=</span> <span class=k>new</span> <span class=n>UserWithRef</span><span class=o>(</span><span class=mi>1</span><span class=o>,</span> <span class=s>&#34;John&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>ItemWithRef</span> <span class=n>item</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ItemWithRef</span><span class=o>(</span><span class=mi>2</span><span class=o>,</span> <span class=s>&#34;book&#34;</span><span class=o>,</span> <span class=n>user</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>user</span><span class=o>.</span><span class=na>addItem</span><span class=o>(</span><span class=n>item</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>result</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectMapper</span><span class=o>().</span><span class=na>writeValueAsString</span><span class=o>(</span><span class=n>item</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>assertThat</span><span class=o>(</span><span class=n>result</span><span class=o>,</span> <span class=n>containsString</span><span class=o>(</span><span class=s>&#34;book&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>assertThat</span><span class=o>(</span><span class=n>result</span><span class=o>,</span> <span class=n>containsString</span><span class=o>(</span><span class=s>&#34;John&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>assertThat</span><span class=o>(</span><span class=n>result</span><span class=o>,</span> <span class=n>not</span><span class=o>(</span><span class=n>containsString</span><span class=o>(</span><span class=s>&#34;userItems&#34;</span><span class=o>)));</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>{</span><span class=s>&#34;id&#34;</span><span class=o>:</span><span class=mi>2</span><span class=o>,</span><span class=s>&#34;itemName&#34;</span><span class=o>:</span><span class=s>&#34;book&#34;</span><span class=o>,</span><span class=s>&#34;owner&#34;</span><span class=o>:{</span><span class=s>&#34;id&#34;</span><span class=o>:</span><span class=mi>1</span><span class=o>,</span><span class=s>&#34;name&#34;</span><span class=o>:</span><span class=s>&#34;zzq&#34;</span><span class=o>}}</span>
</span></span><span class=line><span class=cl><span class=o>{</span><span class=s>&#34;id&#34;</span><span class=o>:</span><span class=mi>1</span><span class=o>,</span><span class=s>&#34;name&#34;</span><span class=o>:</span><span class=s>&#34;zzq&#34;</span><span class=o>}</span>
</span></span></code></pre></div><h3 id=jsonidentityinfo data-numberify>@JsonIdentityInfo<a class="anchor ms-1" href=#jsonidentityinfo></a></h3><p>@JsonIdentityInfo指出在序列化/反序列化值时应该使用对象标识，例如在处理无限递归类型的问题时。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@JsonIdentityInfo</span><span class=o>(</span>
</span></span><span class=line><span class=cl>  <span class=n>generator</span> <span class=o>=</span> <span class=n>ObjectIdGenerators</span><span class=o>.</span><span class=na>PropertyGenerator</span><span class=o>.</span><span class=na>class</span><span class=o>,</span>
</span></span><span class=line><span class=cl>  <span class=n>property</span> <span class=o>=</span> <span class=s>&#34;id&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>ItemWithIdentity</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=n>itemName</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>UserWithIdentity</span> <span class=n>owner</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=nd>@JsonIdentityInfo</span><span class=o>(</span>
</span></span><span class=line><span class=cl>  <span class=n>generator</span> <span class=o>=</span> <span class=n>ObjectIdGenerators</span><span class=o>.</span><span class=na>PropertyGenerator</span><span class=o>.</span><span class=na>class</span><span class=o>,</span>
</span></span><span class=line><span class=cl>  <span class=n>property</span> <span class=o>=</span> <span class=s>&#34;id&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>UserWithIdentity</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>List</span><span class=o>&lt;</span><span class=n>ItemWithIdentity</span><span class=o>&gt;</span> <span class=n>userItems</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Test</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>whenSerializingUsingJsonIdentityInfo_thenCorrect</span><span class=o>()</span>
</span></span><span class=line><span class=cl>  <span class=kd>throws</span> <span class=n>JsonProcessingException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>UserWithIdentity</span> <span class=n>user</span> <span class=o>=</span> <span class=k>new</span> <span class=n>UserWithIdentity</span><span class=o>(</span><span class=mi>1</span><span class=o>,</span> <span class=s>&#34;John&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>ItemWithIdentity</span> <span class=n>item</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ItemWithIdentity</span><span class=o>(</span><span class=mi>2</span><span class=o>,</span> <span class=s>&#34;book&#34;</span><span class=o>,</span> <span class=n>user</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>user</span><span class=o>.</span><span class=na>addItem</span><span class=o>(</span><span class=n>item</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>result</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectMapper</span><span class=o>().</span><span class=na>writeValueAsString</span><span class=o>(</span><span class=n>item</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>assertThat</span><span class=o>(</span><span class=n>result</span><span class=o>,</span> <span class=n>containsString</span><span class=o>(</span><span class=s>&#34;book&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>assertThat</span><span class=o>(</span><span class=n>result</span><span class=o>,</span> <span class=n>containsString</span><span class=o>(</span><span class=s>&#34;John&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>assertThat</span><span class=o>(</span><span class=n>result</span><span class=o>,</span> <span class=n>containsString</span><span class=o>(</span><span class=s>&#34;userItems&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;id&#34;</span><span class=o>:</span> <span class=mi>2</span><span class=o>,</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;itemName&#34;</span><span class=o>:</span> <span class=s>&#34;book&#34;</span><span class=o>,</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;owner&#34;</span><span class=o>:</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=s>&#34;id&#34;</span><span class=o>:</span> <span class=mi>1</span><span class=o>,</span>
</span></span><span class=line><span class=cl>        <span class=s>&#34;name&#34;</span><span class=o>:</span> <span class=s>&#34;John&#34;</span><span class=o>,</span>
</span></span><span class=line><span class=cl>        <span class=s>&#34;userItems&#34;</span><span class=o>:</span> <span class=o>[</span>
</span></span><span class=line><span class=cl>            <span class=mi>2</span>
</span></span><span class=line><span class=cl>        <span class=o>]</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h3 id=jsonfilter data-numberify>@JsonFilter<a class="anchor ms-1" href=#jsonfilter></a></h3><p>@JsonFilter注释指定了在序列化过程中使用的过滤器。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@JsonFilter</span><span class=o>(</span><span class=s>&#34;myFilter&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>BeanWithFilter</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=nd>@Test</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>whenSerializingUsingJsonFilter_thenCorrect</span><span class=o>()</span>
</span></span><span class=line><span class=cl>  <span class=kd>throws</span> <span class=n>JsonProcessingException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>BeanWithFilter</span> <span class=n>bean</span> <span class=o>=</span> <span class=k>new</span> <span class=n>BeanWithFilter</span><span class=o>(</span><span class=mi>1</span><span class=o>,</span> <span class=s>&#34;My bean&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>FilterProvider</span> <span class=n>filters</span> 
</span></span><span class=line><span class=cl>      <span class=o>=</span> <span class=k>new</span> <span class=n>SimpleFilterProvider</span><span class=o>().</span><span class=na>addFilter</span><span class=o>(</span>
</span></span><span class=line><span class=cl>        <span class=s>&#34;myFilter&#34;</span><span class=o>,</span> 
</span></span><span class=line><span class=cl>        <span class=n>SimpleBeanPropertyFilter</span><span class=o>.</span><span class=na>filterOutAllExcept</span><span class=o>(</span><span class=s>&#34;name&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>result</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectMapper</span><span class=o>()</span>
</span></span><span class=line><span class=cl>      <span class=o>.</span><span class=na>writer</span><span class=o>(</span><span class=n>filters</span><span class=o>)</span>
</span></span><span class=line><span class=cl>      <span class=o>.</span><span class=na>writeValueAsString</span><span class=o>(</span><span class=n>bean</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>assertThat</span><span class=o>(</span><span class=n>result</span><span class=o>,</span> <span class=n>containsString</span><span class=o>(</span><span class=s>&#34;My bean&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>assertThat</span><span class=o>(</span><span class=n>result</span><span class=o>,</span> <span class=n>not</span><span class=o>(</span><span class=n>containsString</span><span class=o>(</span><span class=s>&#34;id&#34;</span><span class=o>)));</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h2 id=序列化 data-numberify>序列化<a class="anchor ms-1" href=#序列化></a></h2><h3 id=jsonanygetter data-numberify>@JsonAnyGetter<a class="anchor ms-1" href=#jsonanygetter></a></h3><p>@JsonAnyGetter允许灵活使用Map字段作为标准属性。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>User</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Map</span><span class=o>&lt;</span><span class=n>String</span><span class=o>,</span> <span class=n>Object</span><span class=o>&gt;</span> <span class=n>others</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>User</span> <span class=n>user</span> <span class=o>=</span> <span class=k>new</span> <span class=n>User</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=n>user</span><span class=o>.</span><span class=na>setName</span><span class=o>(</span><span class=s>&#34;zzq&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>user</span><span class=o>.</span><span class=na>setOthers</span><span class=o>(</span><span class=n>Map</span><span class=o>.</span><span class=na>of</span><span class=o>(</span><span class=s>&#34;age&#34;</span><span class=o>,</span> <span class=mi>12</span><span class=o>,</span> <span class=s>&#34;height&#34;</span><span class=o>,</span> <span class=mi>178</span><span class=o>));</span>
</span></span><span class=line><span class=cl><span class=n>String</span> <span class=n>s</span> <span class=o>=</span> <span class=n>objectMapper</span><span class=o>.</span><span class=na>writeValueAsString</span><span class=o>(</span><span class=n>user</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>System</span><span class=o>.</span><span class=na>err</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>s</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>{</span><span class=s>&#34;name&#34;</span><span class=o>:</span><span class=s>&#34;zzq&#34;</span><span class=o>,</span><span class=s>&#34;others&#34;</span><span class=o>:{</span><span class=s>&#34;age&#34;</span><span class=o>:</span><span class=mi>12</span><span class=o>,</span><span class=s>&#34;height&#34;</span><span class=o>:</span><span class=mi>178</span><span class=o>}}</span>
</span></span></code></pre></div><h3 id=jsongetter data-numberify>@JsonGetter<a class="anchor ms-1" href=#jsongetter></a></h3><p>@JsonGetter注释是@JsonProperty注释的替代，将方法标记为getter方法。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>MyBean</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@JsonGetter</span><span class=o>(</span><span class=s>&#34;name&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=nf>getTheName</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>MyBean</span> <span class=n>bean</span> <span class=o>=</span> <span class=k>new</span> <span class=n>MyBean</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=n>bean</span><span class=o>.</span><span class=na>setName</span><span class=o>(</span><span class=s>&#34;zzq&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>bean</span><span class=o>.</span><span class=na>setId</span><span class=o>(</span><span class=mi>1</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>String</span> <span class=n>s</span> <span class=o>=</span> <span class=n>objectMapper</span><span class=o>.</span><span class=na>writeValueAsString</span><span class=o>(</span><span class=n>bean</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>System</span><span class=o>.</span><span class=na>err</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>s</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>{</span><span class=s>&#34;id&#34;</span><span class=o>:</span><span class=mi>1</span><span class=o>,</span><span class=s>&#34;name&#34;</span><span class=o>:</span><span class=s>&#34;zzq&#34;</span><span class=o>}</span>
</span></span></code></pre></div><h3 id=jsonpropertyorder data-numberify>@JsonPropertyOrder<a class="anchor ms-1" href=#jsonpropertyorder></a></h3><p>我们可以使用@JsonPropertyOrder注释来指定序列化时属性的顺序。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@JsonPropertyOrder</span><span class=o>({</span> <span class=s>&#34;name&#34;</span><span class=o>,</span> <span class=s>&#34;id&#34;</span> <span class=o>})</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>MyBean</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>MyBean</span> <span class=n>bean</span> <span class=o>=</span> <span class=k>new</span> <span class=n>MyBean</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=n>bean</span><span class=o>.</span><span class=na>setName</span><span class=o>(</span><span class=s>&#34;zzq&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>bean</span><span class=o>.</span><span class=na>setId</span><span class=o>(</span><span class=mi>1</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>String</span> <span class=n>s</span> <span class=o>=</span> <span class=n>objectMapper</span><span class=o>.</span><span class=na>writeValueAsString</span><span class=o>(</span><span class=n>bean</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>System</span><span class=o>.</span><span class=na>err</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>s</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>{</span><span class=s>&#34;name&#34;</span><span class=o>:</span><span class=s>&#34;zzq&#34;</span><span class=o>,</span><span class=s>&#34;id&#34;</span><span class=o>:</span><span class=mi>1</span><span class=o>}</span>
</span></span></code></pre></div><h3 id=jsonrawvalue data-numberify>@JsonRawValue<a class="anchor ms-1" href=#jsonrawvalue></a></h3><p>@JsonRawValue注释可以指示Jackson按原样序列化属性。</p><p>在下面的示例中，我们使用@JsonRawValue嵌入一些自定义JSON作为实体s属性的值：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>RawBean</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@JsonRawValue</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=n>json</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>RawBean</span> <span class=n>bean</span><span class=o>=</span><span class=k>new</span> <span class=n>RawBean</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=n>bean</span><span class=o>.</span><span class=na>setName</span><span class=o>(</span><span class=s>&#34;zzq&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>bean</span><span class=o>.</span><span class=na>setJson</span><span class=o>(</span><span class=s>&#34;{\&#34;age\&#34;:33}&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>String</span> <span class=n>s</span> <span class=o>=</span> <span class=n>objectMapper</span><span class=o>.</span><span class=na>writeValueAsString</span><span class=o>(</span><span class=n>bean</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>System</span><span class=o>.</span><span class=na>err</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>s</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>{</span><span class=s>&#34;name&#34;</span><span class=o>:</span><span class=s>&#34;zzq&#34;</span><span class=o>,</span><span class=s>&#34;json&#34;</span><span class=o>:{</span><span class=s>&#34;age&#34;</span><span class=o>:</span><span class=mi>33</span><span class=o>}}</span>
</span></span></code></pre></div><h3 id=jsonvalue data-numberify>@JsonValue<a class="anchor ms-1" href=#jsonvalue></a></h3><p>@JsonValue使用标注的方法序列化整个实例。例如，在枚举中，我们用@JsonValue注释getName，以便通过其名称序列化任何这样的实体：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>enum</span> <span class=n>TypeEnumWithValue</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>TYPE1</span><span class=o>(</span><span class=mi>1</span><span class=o>,</span> <span class=s>&#34;Type A&#34;</span><span class=o>),</span> <span class=n>TYPE2</span><span class=o>(</span><span class=mi>2</span><span class=o>,</span> <span class=s>&#34;Type 2&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Integer</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>TypeEnumWithValue</span><span class=o>(</span><span class=kt>int</span> <span class=n>i</span><span class=o>,</span> <span class=n>String</span> <span class=n>s</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>id</span> <span class=o>=</span> <span class=n>i</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>name</span> <span class=o>=</span> <span class=n>s</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@JsonValue</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=nf>getName</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>String</span> <span class=n>s</span> <span class=o>=</span> <span class=n>objectMapper</span><span class=o>.</span><span class=na>writeValueAsString</span><span class=o>(</span><span class=n>TypeEnumWithValue</span><span class=o>.</span><span class=na>TYPE1</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>System</span><span class=o>.</span><span class=na>err</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>s</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=s>&#34;Type A&#34;</span>
</span></span></code></pre></div><h3 id=jsonrootname data-numberify>@JsonRootName<a class="anchor ms-1" href=#jsonrootname></a></h3><p>如果启用了包装，则使用@JsonRootName注释来指定要使用的根包装的名称。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@JsonRootName</span><span class=o>(</span><span class=n>value</span> <span class=o>=</span> <span class=s>&#34;user&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>MyBean</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>objectMapper</span><span class=o>.</span><span class=na>enable</span><span class=o>(</span><span class=n>SerializationFeature</span><span class=o>.</span><span class=na>WRAP_ROOT_VALUE</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>MyBean</span> <span class=n>bean</span> <span class=o>=</span> <span class=k>new</span> <span class=n>MyBean</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=n>bean</span><span class=o>.</span><span class=na>setName</span><span class=o>(</span><span class=s>&#34;zzq&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>bean</span><span class=o>.</span><span class=na>setId</span><span class=o>(</span><span class=mi>1</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>String</span> <span class=n>s</span> <span class=o>=</span> <span class=n>objectMapper</span><span class=o>.</span><span class=na>writeValueAsString</span><span class=o>(</span><span class=n>bean</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>System</span><span class=o>.</span><span class=na>err</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>s</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>{</span><span class=s>&#34;user&#34;</span><span class=o>:{</span><span class=s>&#34;name&#34;</span><span class=o>:</span><span class=s>&#34;zzq&#34;</span><span class=o>,</span><span class=s>&#34;id&#34;</span><span class=o>:</span><span class=mi>1</span><span class=o>}}</span>
</span></span></code></pre></div><h3 id=jsonserialize data-numberify>@JsonSerialize<a class="anchor ms-1" href=#jsonserialize></a></h3><p>@JsonSerialize指示编组实体时要使用的自定义序列化程序。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>EventWithSerializer</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@JsonSerialize</span><span class=o>(</span><span class=n>using</span> <span class=o>=</span> <span class=n>CustomDateSerializer</span><span class=o>.</span><span class=na>class</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>Date</span> <span class=n>eventDate</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>CustomDateSerializer</span> <span class=kd>extends</span> <span class=n>StdSerializer</span><span class=o>&lt;</span><span class=n>Date</span><span class=o>&gt;</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>static</span> <span class=n>SimpleDateFormat</span> <span class=n>formatter</span> 
</span></span><span class=line><span class=cl>      <span class=o>=</span> <span class=k>new</span> <span class=n>SimpleDateFormat</span><span class=o>(</span><span class=s>&#34;dd-MM-yyyy hh:mm:ss&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=nf>CustomDateSerializer</span><span class=o>()</span> <span class=o>{</span> 
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>(</span><span class=kc>null</span><span class=o>);</span> 
</span></span><span class=line><span class=cl>    <span class=o>}</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=nf>CustomDateSerializer</span><span class=o>(</span><span class=n>Class</span><span class=o>&lt;</span><span class=n>Date</span><span class=o>&gt;</span> <span class=n>t</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>super</span><span class=o>(</span><span class=n>t</span><span class=o>);</span> 
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>serialize</span><span class=o>(</span>
</span></span><span class=line><span class=cl>      <span class=n>Date</span> <span class=n>value</span><span class=o>,</span> <span class=n>JsonGenerator</span> <span class=n>gen</span><span class=o>,</span> <span class=n>SerializerProvider</span> <span class=n>arg2</span><span class=o>)</span> 
</span></span><span class=line><span class=cl>      <span class=kd>throws</span> <span class=n>IOException</span><span class=o>,</span> <span class=n>JsonProcessingException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>gen</span><span class=o>.</span><span class=na>writeString</span><span class=o>(</span><span class=n>formatter</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=n>value</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=nd>@Test</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>whenSerializingUsingJsonSerialize_thenCorrect</span><span class=o>()</span>
</span></span><span class=line><span class=cl>  <span class=kd>throws</span> <span class=n>JsonProcessingException</span><span class=o>,</span> <span class=n>ParseException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>    <span class=n>SimpleDateFormat</span> <span class=n>df</span>
</span></span><span class=line><span class=cl>      <span class=o>=</span> <span class=k>new</span> <span class=n>SimpleDateFormat</span><span class=o>(</span><span class=s>&#34;dd-MM-yyyy hh:mm:ss&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>toParse</span> <span class=o>=</span> <span class=s>&#34;20-12-2014 02:30:00&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=n>Date</span> <span class=n>date</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=na>parse</span><span class=o>(</span><span class=n>toParse</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>EventWithSerializer</span> <span class=n>event</span> <span class=o>=</span> <span class=k>new</span> <span class=n>EventWithSerializer</span><span class=o>(</span><span class=s>&#34;party&#34;</span><span class=o>,</span> <span class=n>date</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>result</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectMapper</span><span class=o>().</span><span class=na>writeValueAsString</span><span class=o>(</span><span class=n>event</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>assertThat</span><span class=o>(</span><span class=n>result</span><span class=o>,</span> <span class=n>containsString</span><span class=o>(</span><span class=n>toParse</span><span class=o>));</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h2 id=反序列化 data-numberify>反序列化<a class="anchor ms-1" href=#反序列化></a></h2><h3 id=jsoncreator data-numberify>@JsonCreator<a class="anchor ms-1" href=#jsoncreator></a></h3><p>我们可以使用@JsonCreator注释来调整反序列化中使用的构造函数或构造工厂。当我们需要反序列化与我们需要获取的目标实体不完全匹配的JSON时，这非常有用。</p><p>让我们看一个例子。假设我们需要反序列化以下JSON：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;id&#34;</span><span class=p>:</span><span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;theName&#34;</span><span class=p>:</span><span class=s2>&#34;My bean&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>目标实体中没有<em>theName</em> 字段。只有<em>name</em> 字段。 现在我们不想改变实体本身，我们只需要用@JsonCreator注释构造函数，并使用@JsonProperty注释来对解组过程进行更多的控制：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>BeanWithCreator</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@JsonCreator</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=nf>BeanWithCreator</span><span class=o>(</span>
</span></span><span class=line><span class=cl>        <span class=nd>@JsonProperty</span><span class=o>(</span><span class=s>&#34;id&#34;</span><span class=o>)</span> <span class=kt>int</span> <span class=n>id</span><span class=o>,</span> 
</span></span><span class=line><span class=cl>        <span class=nd>@JsonProperty</span><span class=o>(</span><span class=s>&#34;theName&#34;</span><span class=o>)</span> <span class=n>String</span> <span class=n>name</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>id</span> <span class=o>=</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>name</span> <span class=o>=</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h3 id=jacksoninject data-numberify>@JacksonInject<a class="anchor ms-1" href=#jacksoninject></a></h3><p>@JacksonInject表示属性将从注入而不是从JSON数据中获取其值。</p><p>在下面的示例中，我们使用@JacksonInject注入属性id：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>BeanWithInject</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=nd>@JacksonInject</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=nd>@Test</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>whenDeserializingUsingJsonInject_thenCorrect</span><span class=o>()</span>
</span></span><span class=line><span class=cl>  <span class=kd>throws</span> <span class=n>IOException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>json</span> <span class=o>=</span> <span class=s>&#34;{\&#34;name\&#34;:\&#34;My bean\&#34;}&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>InjectableValues</span> <span class=n>inject</span> <span class=o>=</span> <span class=k>new</span> <span class=n>InjectableValues</span><span class=o>.</span><span class=na>Std</span><span class=o>()</span>
</span></span><span class=line><span class=cl>      <span class=o>.</span><span class=na>addValue</span><span class=o>(</span><span class=kt>int</span><span class=o>.</span><span class=na>class</span><span class=o>,</span> <span class=mi>1</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>BeanWithInject</span> <span class=n>bean</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectMapper</span><span class=o>().</span><span class=na>reader</span><span class=o>(</span><span class=n>inject</span><span class=o>)</span>
</span></span><span class=line><span class=cl>      <span class=o>.</span><span class=na>forType</span><span class=o>(</span><span class=n>BeanWithInject</span><span class=o>.</span><span class=na>class</span><span class=o>)</span>
</span></span><span class=line><span class=cl>      <span class=o>.</span><span class=na>readValue</span><span class=o>(</span><span class=n>json</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>assertEquals</span><span class=o>(</span><span class=s>&#34;My bean&#34;</span><span class=o>,</span> <span class=n>bean</span><span class=o>.</span><span class=na>name</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>assertEquals</span><span class=o>(</span><span class=mi>1</span><span class=o>,</span> <span class=n>bean</span><span class=o>.</span><span class=na>id</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h3 id=jsonanysetter data-numberify>@JsonAnySetter<a class="anchor ms-1" href=#jsonanysetter></a></h3><p>@JsonAnySetter允许我们灵活地使用Map作为标准属性。在反序列化时，JSON中的没有匹配的属性将简单地添加到Map中。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>ExtendableBean</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>Map</span><span class=o>&lt;</span><span class=n>String</span><span class=o>,</span> <span class=n>String</span><span class=o>&gt;</span> <span class=n>properties</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@JsonAnySetter</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>add</span><span class=o>(</span><span class=n>String</span> <span class=n>key</span><span class=o>,</span> <span class=n>String</span> <span class=n>value</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>properties</span><span class=o>.</span><span class=na>put</span><span class=o>(</span><span class=n>key</span><span class=o>,</span> <span class=n>value</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=nd>@Test</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>whenDeserializingUsingJsonAnySetter_thenCorrect</span><span class=o>()</span>
</span></span><span class=line><span class=cl>  <span class=kd>throws</span> <span class=n>IOException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>json</span>
</span></span><span class=line><span class=cl>      <span class=o>=</span> <span class=s>&#34;{\&#34;name\&#34;:\&#34;My bean\&#34;,\&#34;attr2\&#34;:\&#34;val2\&#34;,\&#34;attr1\&#34;:\&#34;val1\&#34;}&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>ExtendableBean</span> <span class=n>bean</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectMapper</span><span class=o>()</span>
</span></span><span class=line><span class=cl>      <span class=o>.</span><span class=na>readerFor</span><span class=o>(</span><span class=n>ExtendableBean</span><span class=o>.</span><span class=na>class</span><span class=o>)</span>
</span></span><span class=line><span class=cl>      <span class=o>.</span><span class=na>readValue</span><span class=o>(</span><span class=n>json</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>assertEquals</span><span class=o>(</span><span class=s>&#34;My bean&#34;</span><span class=o>,</span> <span class=n>bean</span><span class=o>.</span><span class=na>name</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>assertEquals</span><span class=o>(</span><span class=s>&#34;val2&#34;</span><span class=o>,</span> <span class=n>bean</span><span class=o>.</span><span class=na>getProperties</span><span class=o>().</span><span class=na>get</span><span class=o>(</span><span class=s>&#34;attr2&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h3 id=jsonsetter data-numberify>@JsonSetter<a class="anchor ms-1" href=#jsonsetter></a></h3><p>@JsonSetter是@JsonProperty的替代方法，它将该方法标记为setter方法。</p><p>当我们需要读取一些JSON数据时，这非常有用，目标实体类与该数据不完全匹配，因此我们需要调整流程以使其适合。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>MyBean</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@JsonSetter</span><span class=o>(</span><span class=s>&#34;name&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>setTheName</span><span class=o>(</span><span class=n>String</span> <span class=n>name</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>name</span> <span class=o>=</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=nd>@Test</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>whenDeserializingUsingJsonSetter_thenCorrect</span><span class=o>()</span>
</span></span><span class=line><span class=cl>  <span class=kd>throws</span> <span class=n>IOException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>json</span> <span class=o>=</span> <span class=s>&#34;{\&#34;id\&#34;:1,\&#34;name\&#34;:\&#34;My bean\&#34;}&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>MyBean</span> <span class=n>bean</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectMapper</span><span class=o>()</span>
</span></span><span class=line><span class=cl>      <span class=o>.</span><span class=na>readerFor</span><span class=o>(</span><span class=n>MyBean</span><span class=o>.</span><span class=na>class</span><span class=o>)</span>
</span></span><span class=line><span class=cl>      <span class=o>.</span><span class=na>readValue</span><span class=o>(</span><span class=n>json</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>assertEquals</span><span class=o>(</span><span class=s>&#34;My bean&#34;</span><span class=o>,</span> <span class=n>bean</span><span class=o>.</span><span class=na>getTheName</span><span class=o>());</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h3 id=jsondeserialize data-numberify>@JsonDeserialize<a class="anchor ms-1" href=#jsondeserialize></a></h3><p>@JsonDeserialize表示使用自定义反序列化程序。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>EventWithSerializer</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@JsonDeserialize</span><span class=o>(</span><span class=n>using</span> <span class=o>=</span> <span class=n>CustomDateDeserializer</span><span class=o>.</span><span class=na>class</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>Date</span> <span class=n>eventDate</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>CustomDateDeserializer</span>
</span></span><span class=line><span class=cl>  <span class=kd>extends</span> <span class=n>StdDeserializer</span><span class=o>&lt;</span><span class=n>Date</span><span class=o>&gt;</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kd>static</span> <span class=n>SimpleDateFormat</span> <span class=n>formatter</span>
</span></span><span class=line><span class=cl>      <span class=o>=</span> <span class=k>new</span> <span class=n>SimpleDateFormat</span><span class=o>(</span><span class=s>&#34;dd-MM-yyyy hh:mm:ss&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=nf>CustomDateDeserializer</span><span class=o>()</span> <span class=o>{</span> 
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>(</span><span class=kc>null</span><span class=o>);</span> 
</span></span><span class=line><span class=cl>    <span class=o>}</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=nf>CustomDateDeserializer</span><span class=o>(</span><span class=n>Class</span><span class=o>&lt;?&gt;</span> <span class=n>vc</span><span class=o>)</span> <span class=o>{</span> 
</span></span><span class=line><span class=cl>        <span class=kd>super</span><span class=o>(</span><span class=n>vc</span><span class=o>);</span> 
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>Date</span> <span class=nf>deserialize</span><span class=o>(</span>
</span></span><span class=line><span class=cl>      <span class=n>JsonParser</span> <span class=n>jsonparser</span><span class=o>,</span> <span class=n>DeserializationContext</span> <span class=n>context</span><span class=o>)</span> 
</span></span><span class=line><span class=cl>      <span class=kd>throws</span> <span class=n>IOException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>String</span> <span class=n>date</span> <span class=o>=</span> <span class=n>jsonparser</span><span class=o>.</span><span class=na>getText</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>formatter</span><span class=o>.</span><span class=na>parse</span><span class=o>(</span><span class=n>date</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>ParseException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>throw</span> <span class=k>new</span> <span class=n>RuntimeException</span><span class=o>(</span><span class=n>e</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=nd>@Test</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>whenDeserializingUsingJsonDeserialize_thenCorrect</span><span class=o>()</span>
</span></span><span class=line><span class=cl>  <span class=kd>throws</span> <span class=n>IOException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>json</span>
</span></span><span class=line><span class=cl>      <span class=o>=</span> <span class=s>&#34;{&#34;</span><span class=n>name</span><span class=s>&#34;:&#34;</span><span class=n>party</span><span class=s>&#34;,&#34;</span><span class=n>eventDate</span><span class=s>&#34;:&#34;</span><span class=mi>20</span><span class=o>-</span><span class=mi>12</span><span class=o>-</span><span class=mi>2014</span> <span class=mi>02</span><span class=o>:</span><span class=mi>30</span><span class=o>:</span><span class=mi>00</span><span class=s>&#34;}&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>SimpleDateFormat</span> <span class=n>df</span>
</span></span><span class=line><span class=cl>      <span class=o>=</span> <span class=k>new</span> <span class=n>SimpleDateFormat</span><span class=o>(</span><span class=s>&#34;dd-MM-yyyy hh:mm:ss&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>EventWithSerializer</span> <span class=n>event</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectMapper</span><span class=o>()</span>
</span></span><span class=line><span class=cl>      <span class=o>.</span><span class=na>readerFor</span><span class=o>(</span><span class=n>EventWithSerializer</span><span class=o>.</span><span class=na>class</span><span class=o>)</span>
</span></span><span class=line><span class=cl>      <span class=o>.</span><span class=na>readValue</span><span class=o>(</span><span class=n>json</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>assertEquals</span><span class=o>(</span>
</span></span><span class=line><span class=cl>      <span class=s>&#34;20-12-2014 02:30:00&#34;</span><span class=o>,</span> <span class=n>df</span><span class=o>.</span><span class=na>format</span><span class=o>(</span><span class=n>event</span><span class=o>.</span><span class=na>eventDate</span><span class=o>));</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h3 id=jsonalias data-numberify>@JsonAlias<a class="anchor ms-1" href=#jsonalias></a></h3><p>@JsonAlias在反序列化期间为属性定义了一个或多个备选名称。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>AliasBean</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=nd>@JsonAlias</span><span class=o>({</span> <span class=s>&#34;fName&#34;</span><span class=o>,</span> <span class=s>&#34;f_name&#34;</span> <span class=o>})</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>firstName</span><span class=o>;</span>   
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>lastName</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>这里我们有一个POJO，我们想将带有fName、f_name和firstName等值的JSON反序列化到POJO的firstName变量中。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Test</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>whenDeserializingUsingJsonAlias_thenCorrect</span><span class=o>()</span> <span class=kd>throws</span> <span class=n>IOException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>json</span> <span class=o>=</span> <span class=s>&#34;{\&#34;fName\&#34;: \&#34;John\&#34;, \&#34;lastName\&#34;: \&#34;Green\&#34;}&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=n>AliasBean</span> <span class=n>aliasBean</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectMapper</span><span class=o>().</span><span class=na>readerFor</span><span class=o>(</span><span class=n>AliasBean</span><span class=o>.</span><span class=na>class</span><span class=o>).</span><span class=na>readValue</span><span class=o>(</span><span class=n>json</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>assertEquals</span><span class=o>(</span><span class=s>&#34;John&#34;</span><span class=o>,</span> <span class=n>aliasBean</span><span class=o>.</span><span class=na>getFirstName</span><span class=o>());</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h2 id=包含 data-numberify>包含<a class="anchor ms-1" href=#包含></a></h2><h3 id=jsonignoreproperties data-numberify>@JsonIgnoreProperties<a class="anchor ms-1" href=#jsonignoreproperties></a></h3><p>@JsonIgnoreProperties是一个类级注释，用于标记忽略的属性或属性列表。序列化和反序列化都支持</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@JsonIgnoreProperties</span><span class=o>({</span> <span class=s>&#34;id&#34;</span> <span class=o>})</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>BeanWithIgnore</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=nd>@Test</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>whenSerializingUsingJsonIgnoreProperties_thenCorrect</span><span class=o>()</span>
</span></span><span class=line><span class=cl>  <span class=kd>throws</span> <span class=n>JsonProcessingException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>    <span class=n>BeanWithIgnore</span> <span class=n>bean</span> <span class=o>=</span> <span class=k>new</span> <span class=n>BeanWithIgnore</span><span class=o>(</span><span class=mi>1</span><span class=o>,</span> <span class=s>&#34;My bean&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>result</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectMapper</span><span class=o>()</span>
</span></span><span class=line><span class=cl>      <span class=o>.</span><span class=na>writeValueAsString</span><span class=o>(</span><span class=n>bean</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>assertThat</span><span class=o>(</span><span class=n>result</span><span class=o>,</span> <span class=n>containsString</span><span class=o>(</span><span class=s>&#34;My bean&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>assertThat</span><span class=o>(</span><span class=n>result</span><span class=o>,</span> <span class=n>not</span><span class=o>(</span><span class=n>containsString</span><span class=o>(</span><span class=s>&#34;id&#34;</span><span class=o>)));</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>忽略JSON输入中的任何未知属性，我们可以设置@JsonIgnoreProperties注释的ignoreUnknown=true。</p><h3 id=jsonignore data-numberify>@JsonIgnore<a class="anchor ms-1" href=#jsonignore></a></h3><p>@JsonIgnore注释用于在字段级别标记要忽略的属性。序列化和反序列化都支持</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>BeanWithIgnore</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=nd>@JsonIgnore</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=nd>@Test</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>whenSerializingUsingJsonIgnore_thenCorrect</span><span class=o>()</span>
</span></span><span class=line><span class=cl>  <span class=kd>throws</span> <span class=n>JsonProcessingException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>    <span class=n>BeanWithIgnore</span> <span class=n>bean</span> <span class=o>=</span> <span class=k>new</span> <span class=n>BeanWithIgnore</span><span class=o>(</span><span class=mi>1</span><span class=o>,</span> <span class=s>&#34;My bean&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>result</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectMapper</span><span class=o>()</span>
</span></span><span class=line><span class=cl>      <span class=o>.</span><span class=na>writeValueAsString</span><span class=o>(</span><span class=n>bean</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>assertThat</span><span class=o>(</span><span class=n>result</span><span class=o>,</span> <span class=n>containsString</span><span class=o>(</span><span class=s>&#34;My bean&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>assertThat</span><span class=o>(</span><span class=n>result</span><span class=o>,</span> <span class=n>not</span><span class=o>(</span><span class=n>containsString</span><span class=o>(</span><span class=s>&#34;id&#34;</span><span class=o>)));</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h3 id=jsonignoretype data-numberify>@JsonIgnoreType<a class="anchor ms-1" href=#jsonignoretype></a></h3><p>@JsonIgnoreType将注释类型的所有属性标记为忽略。序列化和反序列化都支持</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>User</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>Name</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@JsonIgnoreType</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kd>class</span> <span class=nc>Name</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>public</span> <span class=n>String</span> <span class=n>firstName</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=kd>public</span> <span class=n>String</span> <span class=n>lastName</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=nd>@Test</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>whenSerializingUsingJsonIgnoreType_thenCorrect</span><span class=o>()</span>
</span></span><span class=line><span class=cl>  <span class=kd>throws</span> <span class=n>JsonProcessingException</span><span class=o>,</span> <span class=n>ParseException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>    <span class=n>User</span><span class=o>.</span><span class=na>Name</span> <span class=n>name</span> <span class=o>=</span> <span class=k>new</span> <span class=n>User</span><span class=o>.</span><span class=na>Name</span><span class=o>(</span><span class=s>&#34;John&#34;</span><span class=o>,</span> <span class=s>&#34;Doe&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>User</span> <span class=n>user</span> <span class=o>=</span> <span class=k>new</span> <span class=n>User</span><span class=o>(</span><span class=mi>1</span><span class=o>,</span> <span class=n>name</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>result</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectMapper</span><span class=o>()</span>
</span></span><span class=line><span class=cl>      <span class=o>.</span><span class=na>writeValueAsString</span><span class=o>(</span><span class=n>user</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>assertThat</span><span class=o>(</span><span class=n>result</span><span class=o>,</span> <span class=n>containsString</span><span class=o>(</span><span class=s>&#34;1&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>assertThat</span><span class=o>(</span><span class=n>result</span><span class=o>,</span> <span class=n>not</span><span class=o>(</span><span class=n>containsString</span><span class=o>(</span><span class=s>&#34;name&#34;</span><span class=o>)));</span>
</span></span><span class=line><span class=cl>    <span class=n>assertThat</span><span class=o>(</span><span class=n>result</span><span class=o>,</span> <span class=n>not</span><span class=o>(</span><span class=n>containsString</span><span class=o>(</span><span class=s>&#34;John&#34;</span><span class=o>)));</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h3 id=jsoninclude data-numberify>@JsonInclude<a class="anchor ms-1" href=#jsoninclude></a></h3><p>我们可以使用@JsonInclude排除具有空/null/default值的属性。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@JsonInclude</span><span class=o>(</span><span class=n>Include</span><span class=o>.</span><span class=na>NON_NULL</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>MyBean</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>whenSerializingUsingJsonInclude_thenCorrect</span><span class=o>()</span>
</span></span><span class=line><span class=cl>  <span class=kd>throws</span> <span class=n>JsonProcessingException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>    <span class=n>MyBean</span> <span class=n>bean</span> <span class=o>=</span> <span class=k>new</span> <span class=n>MyBean</span><span class=o>(</span><span class=mi>1</span><span class=o>,</span> <span class=kc>null</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>result</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectMapper</span><span class=o>()</span>
</span></span><span class=line><span class=cl>      <span class=o>.</span><span class=na>writeValueAsString</span><span class=o>(</span><span class=n>bean</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>assertThat</span><span class=o>(</span><span class=n>result</span><span class=o>,</span> <span class=n>containsString</span><span class=o>(</span><span class=s>&#34;1&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>assertThat</span><span class=o>(</span><span class=n>result</span><span class=o>,</span> <span class=n>not</span><span class=o>(</span><span class=n>containsString</span><span class=o>(</span><span class=s>&#34;name&#34;</span><span class=o>)));</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h3 id=jsonautodetect data-numberify>@JsonAutoDetect<a class="anchor ms-1" href=#jsonautodetect></a></h3><p>@JsonAutoDetect可以覆盖哪些属性可见，哪些属性不可见的默认语义。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@JsonAutoDetect</span><span class=o>(</span><span class=n>fieldVisibility</span> <span class=o>=</span> <span class=n>Visibility</span><span class=o>.</span><span class=na>ANY</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>PrivateBean</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=nd>@Test</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>whenSerializingUsingJsonAutoDetect_thenCorrect</span><span class=o>()</span>
</span></span><span class=line><span class=cl>  <span class=kd>throws</span> <span class=n>JsonProcessingException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>    <span class=n>PrivateBean</span> <span class=n>bean</span> <span class=o>=</span> <span class=k>new</span> <span class=n>PrivateBean</span><span class=o>(</span><span class=mi>1</span><span class=o>,</span> <span class=s>&#34;My bean&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>result</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectMapper</span><span class=o>()</span>
</span></span><span class=line><span class=cl>      <span class=o>.</span><span class=na>writeValueAsString</span><span class=o>(</span><span class=n>bean</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>assertThat</span><span class=o>(</span><span class=n>result</span><span class=o>,</span> <span class=n>containsString</span><span class=o>(</span><span class=s>&#34;1&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>assertThat</span><span class=o>(</span><span class=n>result</span><span class=o>,</span> <span class=n>containsString</span><span class=o>(</span><span class=s>&#34;My bean&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h2 id=多态 data-numberify>多态<a class="anchor ms-1" href=#多态></a></h2><ul><li>@JsonTypeInfo–指示要在序列化中包含的类型信息的详细信息</li><li>@JsonSubTypes–指示带注释类型的子类型</li><li>@JsonTypeName–定义用于带注释类的逻辑类型名称</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Zoo</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>Animal</span> <span class=n>animal</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@JsonTypeInfo</span><span class=o>(</span>
</span></span><span class=line><span class=cl>      <span class=n>use</span> <span class=o>=</span> <span class=n>JsonTypeInfo</span><span class=o>.</span><span class=na>Id</span><span class=o>.</span><span class=na>NAME</span><span class=o>,</span> 
</span></span><span class=line><span class=cl>      <span class=n>include</span> <span class=o>=</span> <span class=n>As</span><span class=o>.</span><span class=na>PROPERTY</span><span class=o>,</span> 
</span></span><span class=line><span class=cl>      <span class=n>property</span> <span class=o>=</span> <span class=s>&#34;type&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=nd>@JsonSubTypes</span><span class=o>({</span>
</span></span><span class=line><span class=cl>        <span class=nd>@JsonSubTypes.Type</span><span class=o>(</span><span class=n>value</span> <span class=o>=</span> <span class=n>Dog</span><span class=o>.</span><span class=na>class</span><span class=o>,</span> <span class=n>name</span> <span class=o>=</span> <span class=s>&#34;dog&#34;</span><span class=o>),</span>
</span></span><span class=line><span class=cl>        <span class=nd>@JsonSubTypes.Type</span><span class=o>(</span><span class=n>value</span> <span class=o>=</span> <span class=n>Cat</span><span class=o>.</span><span class=na>class</span><span class=o>,</span> <span class=n>name</span> <span class=o>=</span> <span class=s>&#34;cat&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=o>})</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kd>class</span> <span class=nc>Animal</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>public</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@JsonTypeName</span><span class=o>(</span><span class=s>&#34;dog&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kd>class</span> <span class=nc>Dog</span> <span class=kd>extends</span> <span class=n>Animal</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>public</span> <span class=kt>double</span> <span class=n>barkVolume</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@JsonTypeName</span><span class=o>(</span><span class=s>&#34;cat&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kd>class</span> <span class=nc>Cat</span> <span class=kd>extends</span> <span class=n>Animal</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>boolean</span> <span class=n>likesCream</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=kd>public</span> <span class=kt>int</span> <span class=n>lives</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=nd>@Test</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>whenSerializingPolymorphic_thenCorrect</span><span class=o>()</span>
</span></span><span class=line><span class=cl>  <span class=kd>throws</span> <span class=n>JsonProcessingException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Zoo</span><span class=o>.</span><span class=na>Dog</span> <span class=n>dog</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Zoo</span><span class=o>.</span><span class=na>Dog</span><span class=o>(</span><span class=s>&#34;lacy&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>Zoo</span> <span class=n>zoo</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Zoo</span><span class=o>(</span><span class=n>dog</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>result</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectMapper</span><span class=o>()</span>
</span></span><span class=line><span class=cl>      <span class=o>.</span><span class=na>writeValueAsString</span><span class=o>(</span><span class=n>zoo</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>assertThat</span><span class=o>(</span><span class=n>result</span><span class=o>,</span> <span class=n>containsString</span><span class=o>(</span><span class=s>&#34;type&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>assertThat</span><span class=o>(</span><span class=n>result</span><span class=o>,</span> <span class=n>containsString</span><span class=o>(</span><span class=s>&#34;dog&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>以下是使用Dog序列化Zoo实例的结果：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;animal&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;dog&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;lacy&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;barkVolume&#34;</span><span class=p>:</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>现在进行反序列化。让我们从以下JSON输入开始：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;animal&#34;</span><span class=p>:{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;name&#34;</span><span class=p>:</span><span class=s2>&#34;lacy&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;type&#34;</span><span class=p>:</span><span class=s2>&#34;cat&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>@Test</span>
</span></span><span class=line><span class=cl><span class=err>public</span> <span class=err>void</span> <span class=err>whenDeserializingPolymorphic_thenCorrect()</span>
</span></span><span class=line><span class=cl><span class=err>throws</span> <span class=err>IOException</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=err>String</span> <span class=err>json</span> <span class=err>=</span> <span class=nt>&#34;{\&#34;animal\&#34;:{\&#34;name\&#34;:\&#34;lacy\&#34;,\&#34;type\&#34;:\&#34;cat\&#34;}}&#34;</span><span class=err>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=err>Zoo</span> <span class=err>zoo</span> <span class=err>=</span> <span class=err>new</span> <span class=err>ObjectMapper()</span>
</span></span><span class=line><span class=cl>      <span class=err>.readerFor(Zoo.class)</span>
</span></span><span class=line><span class=cl>      <span class=err>.readValue(json);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=err>assertEquals(</span><span class=s2>&#34;lacy&#34;</span><span class=p>,</span> <span class=err>zoo.animal.name);</span>
</span></span><span class=line><span class=cl>    <span class=err>assertEquals(Zoo.Cat.class,</span> <span class=err>zoo.animal.getClass());</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h2 id=自定义注解 data-numberify>自定义注解<a class="anchor ms-1" href=#自定义注解></a></h2><p>接下来，让我们看看如何创建自定义Jackson注释。我们可以使用@JacksonAnnotationsInside注释：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl>    <span class=nd>@Retention</span><span class=o>(</span><span class=n>RetentionPolicy</span><span class=o>.</span><span class=na>RUNTIME</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=nd>@JacksonAnnotationsInside</span>
</span></span><span class=line><span class=cl>    <span class=nd>@JsonInclude</span><span class=o>(</span><span class=n>Include</span><span class=o>.</span><span class=na>NON_NULL</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=nd>@JsonPropertyOrder</span><span class=o>({</span> <span class=s>&#34;name&#34;</span><span class=o>,</span> <span class=s>&#34;id&#34;</span><span class=o>,</span> <span class=s>&#34;dateCreated&#34;</span> <span class=o>})</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=nd>@interface</span> <span class=n>CustomAnnotation</span> <span class=o>{}</span>
</span></span></code></pre></div><p>现在，如果我们在实体上使用新注释：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@CustomAnnotation</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>BeanWithCustomAnnotation</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>Date</span> <span class=n>dateCreated</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>我们可以看到它如何将现有注释组合成一个简单的自定义注释，我们可以将其用作速记：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Test</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>whenSerializingUsingCustomAnnotation_thenCorrect</span><span class=o>()</span>
</span></span><span class=line><span class=cl>  <span class=kd>throws</span> <span class=n>JsonProcessingException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>BeanWithCustomAnnotation</span> <span class=n>bean</span> 
</span></span><span class=line><span class=cl>      <span class=o>=</span> <span class=k>new</span> <span class=n>BeanWithCustomAnnotation</span><span class=o>(</span><span class=mi>1</span><span class=o>,</span> <span class=s>&#34;My bean&#34;</span><span class=o>,</span> <span class=kc>null</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>result</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectMapper</span><span class=o>().</span><span class=na>writeValueAsString</span><span class=o>(</span><span class=n>bean</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>assertThat</span><span class=o>(</span><span class=n>result</span><span class=o>,</span> <span class=n>containsString</span><span class=o>(</span><span class=s>&#34;My bean&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>assertThat</span><span class=o>(</span><span class=n>result</span><span class=o>,</span> <span class=n>containsString</span><span class=o>(</span><span class=s>&#34;1&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>assertThat</span><span class=o>(</span><span class=n>result</span><span class=o>,</span> <span class=n>not</span><span class=o>(</span><span class=n>containsString</span><span class=o>(</span><span class=s>&#34;dateCreated&#34;</span><span class=o>)));</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;name&#34;</span><span class=o>:</span><span class=s>&#34;My bean&#34;</span><span class=o>,</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;id&#34;</span><span class=o>:</span><span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h2 id=混入 data-numberify>混入<a class="anchor ms-1" href=#混入></a></h2><p>我们使用MixIn注释忽略User类型的属性：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Item</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=n>itemName</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>User</span> <span class=n>owner</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=nd>@JsonIgnoreType</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>MyMixInForIgnoreType</span> <span class=o>{}</span>
</span></span><span class=line><span class=cl><span class=nd>@Test</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>whenSerializingUsingMixInAnnotation_thenCorrect</span><span class=o>()</span> 
</span></span><span class=line><span class=cl>  <span class=kd>throws</span> <span class=n>JsonProcessingException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Item</span> <span class=n>item</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Item</span><span class=o>(</span><span class=mi>1</span><span class=o>,</span> <span class=s>&#34;book&#34;</span><span class=o>,</span> <span class=kc>null</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>result</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectMapper</span><span class=o>().</span><span class=na>writeValueAsString</span><span class=o>(</span><span class=n>item</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>assertThat</span><span class=o>(</span><span class=n>result</span><span class=o>,</span> <span class=n>containsString</span><span class=o>(</span><span class=s>&#34;owner&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>ObjectMapper</span> <span class=n>mapper</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectMapper</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=n>mapper</span><span class=o>.</span><span class=na>addMixIn</span><span class=o>(</span><span class=n>User</span><span class=o>.</span><span class=na>class</span><span class=o>,</span> <span class=n>MyMixInForIgnoreType</span><span class=o>.</span><span class=na>class</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>result</span> <span class=o>=</span> <span class=n>mapper</span><span class=o>.</span><span class=na>writeValueAsString</span><span class=o>(</span><span class=n>item</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>assertThat</span><span class=o>(</span><span class=n>result</span><span class=o>,</span> <span class=n>not</span><span class=o>(</span><span class=n>containsString</span><span class=o>(</span><span class=s>&#34;owner&#34;</span><span class=o>)));</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h2 id=其他 data-numberify>其他<a class="anchor ms-1" href=#其他></a></h2><h3 id=jsonidentityreference data-numberify>@JsonIdentityReference<a class="anchor ms-1" href=#jsonidentityreference></a></h3><p>@JsonIdentityReference用于自定义对对象的引用，这些对象将序列化为对象标识，而不是完整的POJO。它与@JsonIdentityInfo协作，强制在每次序列化中使用对象标识，这与除了第一次缺少@JsonIdentityReference之外的所有序列化不同。当处理对象之间的循环依赖关系时，这两个注释非常有用。</p><p>为了演示使用@JsonIdentityReference，我们将定义两个不同的bean类，不使用和使用该注释。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@JsonIdentityInfo</span><span class=o>(</span><span class=n>generator</span> <span class=o>=</span> <span class=n>ObjectIdGenerators</span><span class=o>.</span><span class=na>PropertyGenerator</span><span class=o>.</span><span class=na>class</span><span class=o>,</span> <span class=n>property</span> <span class=o>=</span> <span class=s>&#34;id&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>BeanWithoutIdentityReference</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// constructor, getters and setters
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=n>BeanWithoutIdentityReference</span> <span class=n>bean</span> 
</span></span><span class=line><span class=cl>  <span class=o>=</span> <span class=k>new</span> <span class=n>BeanWithoutIdentityReference</span><span class=o>(</span><span class=mi>1</span><span class=o>,</span> <span class=s>&#34;Bean Without Identity Reference Annotation&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>String</span> <span class=n>jsonString</span> <span class=o>=</span> <span class=n>mapper</span><span class=o>.</span><span class=na>writeValueAsString</span><span class=o>(</span><span class=n>bean</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;id&#34;</span><span class=o>:</span> <span class=mi>1</span><span class=o>,</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;name&#34;</span><span class=o>:</span> <span class=s>&#34;Bean Without Identity Reference Annotation&#34;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><hr><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@JsonIdentityInfo</span><span class=o>(</span><span class=n>generator</span> <span class=o>=</span> <span class=n>ObjectIdGenerators</span><span class=o>.</span><span class=na>PropertyGenerator</span><span class=o>.</span><span class=na>class</span><span class=o>,</span> <span class=n>property</span> <span class=o>=</span> <span class=s>&#34;id&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=nd>@JsonIdentityReference</span><span class=o>(</span><span class=n>alwaysAsId</span> <span class=o>=</span> <span class=kc>true</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>BeanWithIdentityReference</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// constructor, getters and setters
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=n>BeanWithIdentityReference</span> <span class=n>bean</span> 
</span></span><span class=line><span class=cl>  <span class=o>=</span> <span class=k>new</span> <span class=n>BeanWithIdentityReference</span><span class=o>(</span><span class=mi>1</span><span class=o>,</span> <span class=s>&#34;Bean With Identity Reference Annotation&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>String</span> <span class=n>jsonString</span> <span class=o>=</span> <span class=n>mapper</span><span class=o>.</span><span class=na>writeValueAsString</span><span class=o>(</span><span class=n>bean</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>assertEquals</span><span class=o>(</span><span class=s>&#34;1&#34;</span><span class=o>,</span> <span class=n>jsonString</span><span class=o>);</span>
</span></span></code></pre></div><h3 id=jsonappend data-numberify>@JsonAppend<a class="anchor ms-1" href=#jsonappend></a></h3><p>当对象序列化时，@JsonAppend注释用于将虚拟属性添加到对象中，而不是常规属性。当我们想将补充信息直接添加到JSON字符串中，而不是更改类定义时，这是必要的。例如，将bean的版本元数据插入相应的JSON文档可能比为其提供附加属性更方便。</p><p>假设我们有一个没有@JsonAppend的bean，如下所示：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>BeanWithoutAppend</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// constructor, getters and setters
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span></code></pre></div><p>测试将确认，在缺少@JsonAppend注释的情况下，序列化输出不包含关于补充版本属性的信息，尽管我们试图将其添加到ObjectWriter对象：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>BeanWithoutAppend</span> <span class=n>bean</span> <span class=o>=</span> <span class=k>new</span> <span class=n>BeanWithoutAppend</span><span class=o>(</span><span class=mi>2</span><span class=o>,</span> <span class=s>&#34;Bean Without Append Annotation&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>ObjectWriter</span> <span class=n>writer</span> 
</span></span><span class=line><span class=cl>  <span class=o>=</span> <span class=n>mapper</span><span class=o>.</span><span class=na>writerFor</span><span class=o>(</span><span class=n>BeanWithoutAppend</span><span class=o>.</span><span class=na>class</span><span class=o>).</span><span class=na>withAttribute</span><span class=o>(</span><span class=s>&#34;version&#34;</span><span class=o>,</span> <span class=s>&#34;1.0&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>String</span> <span class=n>jsonString</span> <span class=o>=</span> <span class=n>writer</span><span class=o>.</span><span class=na>writeValueAsString</span><span class=o>(</span><span class=n>bean</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;id&#34;</span><span class=o>:</span> <span class=mi>2</span><span class=o>,</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;name&#34;</span><span class=o>:</span> <span class=s>&#34;Bean Without Append Annotation&#34;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>现在，假设我们有一个用@JsonAppend注释的bean：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@JsonAppend</span><span class=o>(</span><span class=n>attrs</span> <span class=o>=</span> <span class=o>{</span> 
</span></span><span class=line><span class=cl>  <span class=nd>@JsonAppend.Attr</span><span class=o>(</span><span class=n>value</span> <span class=o>=</span> <span class=s>&#34;version&#34;</span><span class=o>)</span> 
</span></span><span class=line><span class=cl><span class=o>})</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>BeanWithAppend</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// constructor, getters and setters
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span></code></pre></div><p>与前一个类似的测试将验证当应用@JsonAppend注释时，在序列化后是否包含补充属性：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>BeanWithAppend</span> <span class=n>bean</span> <span class=o>=</span> <span class=k>new</span> <span class=n>BeanWithAppend</span><span class=o>(</span><span class=mi>2</span><span class=o>,</span> <span class=s>&#34;Bean With Append Annotation&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>ObjectWriter</span> <span class=n>writer</span> 
</span></span><span class=line><span class=cl>  <span class=o>=</span> <span class=n>mapper</span><span class=o>.</span><span class=na>writerFor</span><span class=o>(</span><span class=n>BeanWithAppend</span><span class=o>.</span><span class=na>class</span><span class=o>).</span><span class=na>withAttribute</span><span class=o>(</span><span class=s>&#34;version&#34;</span><span class=o>,</span> <span class=s>&#34;1.0&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>String</span> <span class=n>jsonString</span> <span class=o>=</span> <span class=n>writer</span><span class=o>.</span><span class=na>writeValueAsString</span><span class=o>(</span><span class=n>bean</span><span class=o>);</span>
</span></span></code></pre></div><p>该序列化的输出显示已添加版本属性：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;id&#34;</span><span class=p>:</span> <span class=mi>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;Bean With Append Annotation&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;version&#34;</span><span class=p>:</span> <span class=s2>&#34;1.0&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=jsonnaming data-numberify>@JsonNaming<a class="anchor ms-1" href=#jsonnaming></a></h3><p>@JsonNaming注释用于选择序列化中属性的命名策略，覆盖默认值。使用value元素，我们可以指定任何策略，包括自定义策略。</p><p>除了默认值LOWER_CAMEL_CASE之外，Jackson库还为我们提供了其他四种内置属性命名策略：</p><ul><li>KEBAB_CASE：名称元素用连字符<code>(-)</code>隔开，例如<em>kebab-case</em>.。</li><li>LOWER_CASE：所有字母都是小写，没有分隔符，例如小写。</li><li>SNAKE_CASE：所有字母均为小写，名称元素之间用下划线分隔，例如SNAKE_CASE。</li><li>UPPER_CAMEL_CASE：所有名称元素，包括第一个，都以大写字母开头，后跟小写字母，并且没有分隔符，例如UpperCamelCase。</li></ul><p>此示例将说明使用s<em>SNAKE_CASE</em> 名称序列化属性的方法，其中名为beanName的属性被序列化为bean_name。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@JsonNaming</span><span class=o>(</span><span class=n>PropertyNamingStrategies</span><span class=o>.</span><span class=na>SnakeCaseStrategy</span><span class=o>.</span><span class=na>class</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>NamingBean</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>beanName</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// constructor, getters and setters
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=n>NamingBean</span> <span class=n>bean</span> <span class=o>=</span> <span class=k>new</span> <span class=n>NamingBean</span><span class=o>(</span><span class=mi>3</span><span class=o>,</span> <span class=s>&#34;Naming Bean&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>String</span> <span class=n>jsonString</span> <span class=o>=</span> <span class=n>mapper</span><span class=o>.</span><span class=na>writeValueAsString</span><span class=o>(</span><span class=n>bean</span><span class=o>);</span>        
</span></span><span class=line><span class=cl><span class=n>assertThat</span><span class=o>(</span><span class=n>jsonString</span><span class=o>,</span> <span class=n>containsString</span><span class=o>(</span><span class=s>&#34;bean_name&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;id&#34;</span><span class=o>:</span> <span class=mi>3</span><span class=o>,</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;bean_name&#34;</span><span class=o>:</span> <span class=s>&#34;Naming Bean&#34;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h3 id=jsonpropertydescription data-numberify>@JsonPropertyDescription<a class="anchor ms-1" href=#jsonpropertydescription></a></h3><p>Jackson库能够在名为JSON schema的单独模块的帮助下为Java类型创建JSON模式。当我们希望在序列化Java对象时指定预期输出，或者在反序列化之前验证JSON文档时，该模式非常有用。</p><p>@JsonPropertyDescription注释允许通过提供描述字段将人类可读的描述添加到创建的JSON模式中。</p><p>本节使用下面声明的bean来演示@JsonPropertyDescription的功能：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>PropertyDescriptionBean</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=nd>@JsonPropertyDescription</span><span class=o>(</span><span class=s>&#34;This is a description of the name property&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// getters and setters
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span></code></pre></div><p>通过添加描述字段生成JSON模式的方法如下所示：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>SchemaFactoryWrapper</span> <span class=n>wrapper</span> <span class=o>=</span> <span class=k>new</span> <span class=n>SchemaFactoryWrapper</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=n>mapper</span><span class=o>.</span><span class=na>acceptJsonFormatVisitor</span><span class=o>(</span><span class=n>PropertyDescriptionBean</span><span class=o>.</span><span class=na>class</span><span class=o>,</span> <span class=n>wrapper</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>JsonSchema</span> <span class=n>jsonSchema</span> <span class=o>=</span> <span class=n>wrapper</span><span class=o>.</span><span class=na>finalSchema</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=n>String</span> <span class=n>jsonString</span> <span class=o>=</span> <span class=n>mapper</span><span class=o>.</span><span class=na>writeValueAsString</span><span class=o>(</span><span class=n>jsonSchema</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>assertThat</span><span class=o>(</span><span class=n>jsonString</span><span class=o>,</span> <span class=n>containsString</span><span class=o>(</span><span class=s>&#34;This is a description of the name property&#34;</span><span class=o>));</span>
</span></span></code></pre></div><p>如我们所见，JSON模式的生成是成功的：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;object&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;id&#34;</span><span class=p>:</span> <span class=s2>&#34;urn:jsonschema:com:baeldung:jackson:annotation:extra:PropertyDescriptionBean&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;properties&#34;</span><span class=p>:</span> 
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;name&#34;</span><span class=p>:</span> 
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;string&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;description&#34;</span><span class=p>:</span> <span class=s2>&#34;This is a description of the name property&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;id&#34;</span><span class=p>:</span> 
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;integer&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=jsonpojobuilder data-numberify>@JsonPOJOBuilder<a class="anchor ms-1" href=#jsonpojobuilder></a></h3><p>@JsonPOJOBuider注释用于配置构建器类，以便在命名约定与默认约定不同时自定义JSON文档的反序列化以恢复POJO。</p><p>假设我们需要反序列化以下JSON字符串：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;id&#34;</span><span class=p>:</span> <span class=mi>5</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;POJO Builder Bean&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>该JSON源将用于创建POJOBuilderBean的实例：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@JsonDeserialize</span><span class=o>(</span><span class=n>builder</span> <span class=o>=</span> <span class=n>BeanBuilder</span><span class=o>.</span><span class=na>class</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>POJOBuilderBean</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>int</span> <span class=n>identity</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>beanName</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// constructor, getters and setters
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span></code></pre></div><p>bean属性的名称与JSON字符串中字段的名称不同。这就是@JsonPOJOBuider前来救援的地方。</p><p>@JsonPOJOBuider注释附带两个属性：</p><ul><li><em>buildMethodName:</em> 将JSON字段绑定到预期bean的属性后，用于实例化该bean的无参数方法的名称。默认名称为build。</li><li><em>withPrefix:</em> 用于自动检测JSON和bean属性之间匹配的名称前缀。默认前缀为with。</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@JsonPOJOBuilder</span><span class=o>(</span><span class=n>buildMethodName</span> <span class=o>=</span> <span class=s>&#34;createBean&#34;</span><span class=o>,</span> <span class=n>withPrefix</span> <span class=o>=</span> <span class=s>&#34;construct&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>BeanBuilder</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>int</span> <span class=n>idValue</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>nameValue</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>BeanBuilder</span> <span class=nf>constructId</span><span class=o>(</span><span class=kt>int</span> <span class=n>id</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>idValue</span> <span class=o>=</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>this</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>BeanBuilder</span> <span class=nf>constructName</span><span class=o>(</span><span class=n>String</span> <span class=n>name</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>nameValue</span> <span class=o>=</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>this</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>POJOBuilderBean</span> <span class=nf>createBean</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>new</span> <span class=n>POJOBuilderBean</span><span class=o>(</span><span class=n>idValue</span><span class=o>,</span> <span class=n>nameValue</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>在上面的代码中，我们配置了@JsonPOJOBuilder以使用名为createBean的构建方法和匹配属性的构造前缀。</p><p>@JsonPOJOBuilder对bean的应用程序描述和测试如下：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>String</span> <span class=n>jsonString</span> <span class=o>=</span> <span class=s>&#34;{\&#34;id\&#34;:5,\&#34;name\&#34;:\&#34;POJO Builder Bean\&#34;}&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=n>POJOBuilderBean</span> <span class=n>bean</span> <span class=o>=</span> <span class=n>mapper</span><span class=o>.</span><span class=na>readValue</span><span class=o>(</span><span class=n>jsonString</span><span class=o>,</span> <span class=n>POJOBuilderBean</span><span class=o>.</span><span class=na>class</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>assertEquals</span><span class=o>(</span><span class=mi>5</span><span class=o>,</span> <span class=n>bean</span><span class=o>.</span><span class=na>getIdentity</span><span class=o>());</span>
</span></span><span class=line><span class=cl><span class=n>assertEquals</span><span class=o>(</span><span class=s>&#34;POJO Builder Bean&#34;</span><span class=o>,</span> <span class=n>bean</span><span class=o>.</span><span class=na>getBeanName</span><span class=o>());</span>
</span></span></code></pre></div><h3 id=jsontypeid data-numberify>@JsonTypeId<a class="anchor ms-1" href=#jsontypeid></a></h3><p>@JsonTypeId注释用于指示在包含多态类型信息时，应将带注释的属性序列化为类型id，而不是常规属性。该多态元数据在反序列化期间用于重新创建与序列化前相同子类型的对象，而不是声明的超类型。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>TypeIdBean</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=nd>@JsonTypeId</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>String</span> <span class=n>name</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// constructor, getters and setters
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=n>mapper</span><span class=o>.</span><span class=na>enableDefaultTyping</span><span class=o>(</span><span class=n>DefaultTyping</span><span class=o>.</span><span class=na>NON_FINAL</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>TypeIdBean</span> <span class=n>bean</span> <span class=o>=</span> <span class=k>new</span> <span class=n>TypeIdBean</span><span class=o>(</span><span class=mi>6</span><span class=o>,</span> <span class=s>&#34;Type Id Bean&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>String</span> <span class=n>jsonString</span> <span class=o>=</span> <span class=n>mapper</span><span class=o>.</span><span class=na>writeValueAsString</span><span class=o>(</span><span class=n>bean</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl><span class=n>assertThat</span><span class=o>(</span><span class=n>jsonString</span><span class=o>,</span> <span class=n>containsString</span><span class=o>(</span><span class=s>&#34;Type Id Bean&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl><span class=o>[</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;Type Id Bean&#34;</span><span class=o>,</span>
</span></span><span class=line><span class=cl>    <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=s>&#34;id&#34;</span><span class=o>:</span> <span class=mi>6</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>]</span>
</span></span></code></pre></div><h3 id=jsontypeidresolver data-numberify>@JsonTypeIdResolver<a class="anchor ms-1" href=#jsontypeidresolver></a></h3><p>@JsonTypeIdResolver注释用于表示序列化和反序列化中的自定义类型标识处理程序。该处理程序负责Java类型和JSON文档中包含的类型id之间的转换。</p><p>假设在处理以下类层次结构时，我们希望在JSON字符串中嵌入类型信息。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@JsonTypeInfo</span><span class=o>(</span>
</span></span><span class=line><span class=cl>  <span class=n>use</span> <span class=o>=</span> <span class=n>JsonTypeInfo</span><span class=o>.</span><span class=na>Id</span><span class=o>.</span><span class=na>NAME</span><span class=o>,</span> 
</span></span><span class=line><span class=cl>  <span class=n>include</span> <span class=o>=</span> <span class=n>JsonTypeInfo</span><span class=o>.</span><span class=na>As</span><span class=o>.</span><span class=na>PROPERTY</span><span class=o>,</span> 
</span></span><span class=line><span class=cl>  <span class=n>property</span> <span class=o>=</span> <span class=s>&#34;@type&#34;</span>
</span></span><span class=line><span class=cl><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=nd>@JsonTypeIdResolver</span><span class=o>(</span><span class=n>BeanIdResolver</span><span class=o>.</span><span class=na>class</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>AbstractBean</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>protected</span> <span class=nf>AbstractBean</span><span class=o>(</span><span class=kt>int</span> <span class=n>id</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=o>.</span><span class=na>id</span> <span class=o>=</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// no-arg constructor, getter and setter
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>FirstBean</span> <span class=kd>extends</span> <span class=n>AbstractBean</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>firstName</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=nf>FirstBean</span><span class=o>(</span><span class=kt>int</span> <span class=n>id</span><span class=o>,</span> <span class=n>String</span> <span class=n>name</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>super</span><span class=o>(</span><span class=n>id</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>setFirstName</span><span class=o>(</span><span class=n>name</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// no-arg constructor, getter and setter
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>LastBean</span> <span class=kd>extends</span> <span class=n>AbstractBean</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>lastName</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=nf>LastBean</span><span class=o>(</span><span class=kt>int</span> <span class=n>id</span><span class=o>,</span> <span class=n>String</span> <span class=n>name</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=kd>super</span><span class=o>(</span><span class=n>id</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>setLastName</span><span class=o>(</span><span class=n>name</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// no-arg constructor, getter and setter
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span></code></pre></div><p>这些类的实例用于填充BeanContainer对象：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>BeanContainer</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>List</span><span class=o>&lt;</span><span class=n>AbstractBean</span><span class=o>&gt;</span> <span class=n>beans</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// getter and setter
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span></code></pre></div><p>我们可以看到，AbstractBean类用@JsonTypeIdResolver进行了注释，这表明它使用自定义TypeIdResorver来决定如何在序列化中包含子类型信息，以及如何反过来使用该元数据。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>BeanIdResolver</span> <span class=kd>extends</span> <span class=n>TypeIdResolverBase</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>JavaType</span> <span class=n>superType</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>init</span><span class=o>(</span><span class=n>JavaType</span> <span class=n>baseType</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>superType</span> <span class=o>=</span> <span class=n>baseType</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>Id</span> <span class=nf>getMechanism</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>Id</span><span class=o>.</span><span class=na>NAME</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=nf>idFromValue</span><span class=o>(</span><span class=n>Object</span> <span class=n>obj</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>idFromValueAndType</span><span class=o>(</span><span class=n>obj</span><span class=o>,</span> <span class=n>obj</span><span class=o>.</span><span class=na>getClass</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>String</span> <span class=nf>idFromValueAndType</span><span class=o>(</span><span class=n>Object</span> <span class=n>obj</span><span class=o>,</span> <span class=n>Class</span><span class=o>&lt;?&gt;</span> <span class=n>subType</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>String</span> <span class=n>typeId</span> <span class=o>=</span> <span class=kc>null</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>switch</span> <span class=o>(</span><span class=n>subType</span><span class=o>.</span><span class=na>getSimpleName</span><span class=o>())</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>case</span> <span class=s>&#34;FirstBean&#34;</span><span class=o>:</span>
</span></span><span class=line><span class=cl>            <span class=n>typeId</span> <span class=o>=</span> <span class=s>&#34;bean1&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>case</span> <span class=s>&#34;LastBean&#34;</span><span class=o>:</span>
</span></span><span class=line><span class=cl>            <span class=n>typeId</span> <span class=o>=</span> <span class=s>&#34;bean2&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>typeId</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>JavaType</span> <span class=nf>typeFromId</span><span class=o>(</span><span class=n>DatabindContext</span> <span class=n>context</span><span class=o>,</span> <span class=n>String</span> <span class=n>id</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Class</span><span class=o>&lt;?&gt;</span> <span class=n>subType</span> <span class=o>=</span> <span class=kc>null</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>switch</span> <span class=o>(</span><span class=n>id</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>case</span> <span class=s>&#34;bean1&#34;</span><span class=o>:</span>
</span></span><span class=line><span class=cl>            <span class=n>subType</span> <span class=o>=</span> <span class=n>FirstBean</span><span class=o>.</span><span class=na>class</span><span class=o>;</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=k>case</span> <span class=s>&#34;bean2&#34;</span><span class=o>:</span>
</span></span><span class=line><span class=cl>            <span class=n>subType</span> <span class=o>=</span> <span class=n>LastBean</span><span class=o>.</span><span class=na>class</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>context</span><span class=o>.</span><span class=na>constructSpecializedType</span><span class=o>(</span><span class=n>superType</span><span class=o>,</span> <span class=n>subType</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>最值得注意的两个方法是idFromValueAndType和typeFromId，前者告诉序列化POJO时如何包含类型信息，后者使用该元数据确定重新创建的对象的子类型。</p><p>为了确保序列化和反序列化都能正常工作，让我们编写一个测试来验证完整的进度。</p><p>首先，我们需要实例化一个bean容器和bean类，然后用bean实例填充该容器：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>FirstBean</span> <span class=n>bean1</span> <span class=o>=</span> <span class=k>new</span> <span class=n>FirstBean</span><span class=o>(</span><span class=mi>1</span><span class=o>,</span> <span class=s>&#34;Bean 1&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>LastBean</span> <span class=n>bean2</span> <span class=o>=</span> <span class=k>new</span> <span class=n>LastBean</span><span class=o>(</span><span class=mi>2</span><span class=o>,</span> <span class=s>&#34;Bean 2&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>List</span><span class=o>&lt;</span><span class=n>AbstractBean</span><span class=o>&gt;</span> <span class=n>beans</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;&gt;();</span>
</span></span><span class=line><span class=cl><span class=n>beans</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=n>bean1</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>beans</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=n>bean2</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>BeanContainer</span> <span class=n>serializedContainer</span> <span class=o>=</span> <span class=k>new</span> <span class=n>BeanContainer</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=n>serializedContainer</span><span class=o>.</span><span class=na>setBeans</span><span class=o>(</span><span class=n>beans</span><span class=o>);</span>
</span></span></code></pre></div><p>接下来，BeanContainer对象被序列化，我们确认结果字符串包含类型信息：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>String</span> <span class=n>jsonString</span> <span class=o>=</span> <span class=n>mapper</span><span class=o>.</span><span class=na>writeValueAsString</span><span class=o>(</span><span class=n>serializedContainer</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>assertThat</span><span class=o>(</span><span class=n>jsonString</span><span class=o>,</span> <span class=n>containsString</span><span class=o>(</span><span class=s>&#34;bean1&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl><span class=n>assertThat</span><span class=o>(</span><span class=n>jsonString</span><span class=o>,</span> <span class=n>containsString</span><span class=o>(</span><span class=s>&#34;bean2&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;beans&#34;</span><span class=o>:</span> 
</span></span><span class=line><span class=cl>    <span class=o>[</span>
</span></span><span class=line><span class=cl>        <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=s>&#34;@type&#34;</span><span class=o>:</span> <span class=s>&#34;bean1&#34;</span><span class=o>,</span>
</span></span><span class=line><span class=cl>            <span class=s>&#34;id&#34;</span><span class=o>:</span> <span class=mi>1</span><span class=o>,</span>
</span></span><span class=line><span class=cl>            <span class=s>&#34;firstName&#34;</span><span class=o>:</span> <span class=s>&#34;Bean 1&#34;</span>
</span></span><span class=line><span class=cl>        <span class=o>},</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=s>&#34;@type&#34;</span><span class=o>:</span> <span class=s>&#34;bean2&#34;</span><span class=o>,</span>
</span></span><span class=line><span class=cl>            <span class=s>&#34;id&#34;</span><span class=o>:</span> <span class=mi>2</span><span class=o>,</span>
</span></span><span class=line><span class=cl>            <span class=s>&#34;lastName&#34;</span><span class=o>:</span> <span class=s>&#34;Bean 2&#34;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>该JSON结构将用于重新创建与序列化之前相同子类型的对象。以下是反序列化的实现步骤：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=err>BeanContainer</span> <span class=err>deserializedContainer</span> <span class=err>=</span> <span class=err>mapper.readValue(jsonString,</span> <span class=err>BeanContainer.class);</span>
</span></span><span class=line><span class=cl><span class=err>List&lt;AbstractBean&gt;</span> <span class=err>beanList</span> <span class=err>=</span> <span class=err>deserializedContainer.getBeans();</span>
</span></span><span class=line><span class=cl><span class=err>assertThat(beanList.get(</span><span class=mi>0</span><span class=err>),</span> <span class=err>instanceOf(FirstBean.class));</span>
</span></span><span class=line><span class=cl><span class=err>assertThat(beanList.get(</span><span class=mi>1</span><span class=err>),</span> <span class=err>instanceOf(LastBean.class));</span>
</span></span></code></pre></div><h1 id=how-to data-numberify>How To<a class="anchor ms-1" href=#how-to></a></h1><h2 id=编组时如何忽略属性 data-numberify>编组时如何忽略属性？<a class="anchor ms-1" href=#编组时如何忽略属性></a></h2><ul><li>@JsonIgnoreProperties ： 在类上指定忽略的属性</li><li>@JsonIgnore： 在字段上指定忽略的属性</li><li>@JsonIgnoreType：忽略类型的所有属性</li><li>@JsonFilter： 动态忽略属性</li><li>@JsonInclude(Include.NON_NULL)：忽略特定值类型的属性</li></ul><p>参考： <a href=https://www.baeldung.com/jackson-ignore-properties-on-serialization target=_blank rel="noopener noreferrer">https://www.baeldung.com/jackson-ignore-properties-on-serialization<i class="fas fa-external-link-square-alt ms-1"></i></a></p><h2 id=jackson处理optional-字段 data-numberify>jackson处理Optional 字段<a class="anchor ms-1" href=#jackson处理optional-字段></a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Book</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>   <span class=n>String</span> <span class=n>title</span><span class=o>;</span>
</span></span><span class=line><span class=cl>   <span class=n>Optional</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>subTitle</span><span class=o>;</span>
</span></span><span class=line><span class=cl>   
</span></span><span class=line><span class=cl>   <span class=c1>// getters and setters omitted
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span></code></pre></div><p>序列化该对象：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Book</span> <span class=n>book</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Book</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=n>book</span><span class=o>.</span><span class=na>setTitle</span><span class=o>(</span><span class=s>&#34;Oliver Twist&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>book</span><span class=o>.</span><span class=na>setSubTitle</span><span class=o>(</span><span class=n>Optional</span><span class=o>.</span><span class=na>of</span><span class=o>(</span><span class=s>&#34;The Parish Boy&#39;s Progress&#34;</span><span class=o>));</span>
</span></span><span class=line><span class=cl><span class=n>String</span> <span class=n>result</span> <span class=o>=</span> <span class=n>mapper</span><span class=o>.</span><span class=na>writeValueAsString</span><span class=o>(</span><span class=n>book</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>{</span><span class=s>&#34;title&#34;</span><span class=o>:</span><span class=s>&#34;Oliver Twist&#34;</span><span class=o>,</span><span class=s>&#34;subTitle&#34;</span><span class=o>:{</span><span class=s>&#34;present&#34;</span><span class=o>:</span><span class=kc>true</span><span class=o>}}</span>
</span></span></code></pre></div><p>我们将看到，Optional字段的输出不包含其值，而是包含一个嵌套的JSON对象，该对象具有一个名为present的字段.</p><p>在本例中，isPresent是Optional类上的公共getter。这意味着它将被序列化为true或false，具体取决于它是否为空。这是jackson的默认序列化行为。</p><p>现在，让我们反转上一个示例，这次尝试将对象反序列化为可选对象。现在我们将看到JsonMappingException：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Test</span><span class=o>(</span><span class=n>expected</span> <span class=o>=</span> <span class=n>JsonMappingException</span><span class=o>.</span><span class=na>class</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=n>givenFieldWithValue_whenDeserializing_thenThrowException</span>
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>bookJson</span> <span class=o>=</span> <span class=s>&#34;{ \&#34;title\&#34;: \&#34;Oliver Twist\&#34;, \&#34;subTitle\&#34;: \&#34;foo\&#34; }&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=n>Book</span> <span class=n>result</span> <span class=o>=</span> <span class=n>mapper</span><span class=o>.</span><span class=na>readValue</span><span class=o>(</span><span class=n>bookJson</span><span class=o>,</span> <span class=n>Book</span><span class=o>.</span><span class=na>class</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=n>com</span><span class=o>.</span><span class=na>fasterxml</span><span class=o>.</span><span class=na>jackson</span><span class=o>.</span><span class=na>databind</span><span class=o>.</span><span class=na>JsonMappingException</span><span class=o>:</span>
</span></span><span class=line><span class=cl>  <span class=n>Can</span> <span class=n>not</span> <span class=n>construct</span> <span class=n>instance</span> <span class=n>of</span> <span class=n>java</span><span class=o>.</span><span class=na>util</span><span class=o>.</span><span class=na>Optional</span><span class=o>:</span>
</span></span><span class=line><span class=cl>  <span class=n>no</span> <span class=n>String</span><span class=o>-</span><span class=n>argument</span> <span class=n>constructor</span><span class=o>/</span><span class=n>factory</span> <span class=n>method</span> <span class=n>to</span> <span class=n>deserialize</span> <span class=n>from</span> <span class=n>String</span> <span class=nf>value</span> <span class=o>(</span><span class=err>&#39;</span><span class=n>The</span> <span class=n>Parish</span> <span class=n>Boy</span><span class=err>&#39;</span><span class=n>s</span> <span class=n>Progress</span><span class=err>&#39;</span><span class=o>)</span>
</span></span></code></pre></div><p>这种行为再次有意义。本质上，Jackson需要一个构造函数，它可以将<em>subtitle</em> 的值作为参数。我们的可选字段并非如此。</p><p><strong>如何解决呢？</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;dependency&gt;</span>
</span></span><span class=line><span class=cl>   <span class=nt>&lt;groupId&gt;</span>com.fasterxml.jackson.datatype<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>   <span class=nt>&lt;artifactId&gt;</span>jackson-datatype-jdk8<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl>   <span class=nt>&lt;version&gt;</span>2.13.3<span class=nt>&lt;/version&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/dependency&gt;</span>
</span></span><span class=line><span class=cl>ObjectMapper mapper = new ObjectMapper();
</span></span><span class=line><span class=cl>mapper.registerModule(new Jdk8Module());
</span></span></code></pre></div><h2 id=反序列化集合类型 data-numberify>反序列化集合类型？<a class="anchor ms-1" href=#反序列化集合类型></a></h2><h3 id=转换成数组 data-numberify>转换成数组<a class="anchor ms-1" href=#转换成数组></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Test</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>givenJsonArray_whenDeserializingAsArray_thenCorrect</span><span class=o>()</span> 
</span></span><span class=line><span class=cl>  <span class=kd>throws</span> <span class=n>JsonParseException</span><span class=o>,</span> <span class=n>JsonMappingException</span><span class=o>,</span> <span class=n>IOException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>    <span class=n>ObjectMapper</span> <span class=n>mapper</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectMapper</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=n>List</span><span class=o>&lt;</span><span class=n>MyDto</span><span class=o>&gt;</span> <span class=n>listOfDtos</span> <span class=o>=</span> <span class=n>Lists</span><span class=o>.</span><span class=na>newArrayList</span><span class=o>(</span>
</span></span><span class=line><span class=cl>      <span class=k>new</span> <span class=n>MyDto</span><span class=o>(</span><span class=s>&#34;a&#34;</span><span class=o>,</span> <span class=mi>1</span><span class=o>,</span> <span class=kc>true</span><span class=o>),</span> <span class=k>new</span> <span class=n>MyDto</span><span class=o>(</span><span class=s>&#34;bc&#34;</span><span class=o>,</span> <span class=mi>3</span><span class=o>,</span> <span class=kc>false</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>jsonArray</span> <span class=o>=</span> <span class=n>mapper</span><span class=o>.</span><span class=na>writeValueAsString</span><span class=o>(</span><span class=n>listOfDtos</span><span class=o>);</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>    <span class=c1>// [{&#34;stringValue&#34;:&#34;a&#34;,&#34;intValue&#34;:1,&#34;booleanValue&#34;:true},
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// {&#34;stringValue&#34;:&#34;bc&#34;,&#34;intValue&#34;:3,&#34;booleanValue&#34;:false}]
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=n>MyDto</span><span class=o>[]</span> <span class=n>asArray</span> <span class=o>=</span> <span class=n>mapper</span><span class=o>.</span><span class=na>readValue</span><span class=o>(</span><span class=n>jsonArray</span><span class=o>,</span> <span class=n>MyDto</span><span class=o>[].</span><span class=na>class</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>assertThat</span><span class=o>(</span><span class=n>asArray</span><span class=o>[</span><span class=mi>0</span><span class=o>],</span> <span class=n>instanceOf</span><span class=o>(</span><span class=n>MyDto</span><span class=o>.</span><span class=na>class</span><span class=o>));</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h3 id=转换成集合 data-numberify>转换成集合<a class="anchor ms-1" href=#转换成集合></a></h3><p>将同一个JSON数组读入Java集合有点困难——默认情况下，Jackson将无法获得完整的泛型类型信息，而是创建一个LinkedHashMap实例集合：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Test</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>givenJsonArray_whenDeserializingAsListWithNoTypeInfo_thenNotCorrect</span><span class=o>()</span> 
</span></span><span class=line><span class=cl>  <span class=kd>throws</span> <span class=n>JsonParseException</span><span class=o>,</span> <span class=n>JsonMappingException</span><span class=o>,</span> <span class=n>IOException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>    <span class=n>ObjectMapper</span> <span class=n>mapper</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectMapper</span><span class=o>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>List</span><span class=o>&lt;</span><span class=n>MyDto</span><span class=o>&gt;</span> <span class=n>listOfDtos</span> <span class=o>=</span> <span class=n>Lists</span><span class=o>.</span><span class=na>newArrayList</span><span class=o>(</span>
</span></span><span class=line><span class=cl>      <span class=k>new</span> <span class=n>MyDto</span><span class=o>(</span><span class=s>&#34;a&#34;</span><span class=o>,</span> <span class=mi>1</span><span class=o>,</span> <span class=kc>true</span><span class=o>),</span> <span class=k>new</span> <span class=n>MyDto</span><span class=o>(</span><span class=s>&#34;bc&#34;</span><span class=o>,</span> <span class=mi>3</span><span class=o>,</span> <span class=kc>false</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>jsonArray</span> <span class=o>=</span> <span class=n>mapper</span><span class=o>.</span><span class=na>writeValueAsString</span><span class=o>(</span><span class=n>listOfDtos</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>List</span><span class=o>&lt;</span><span class=n>MyDto</span><span class=o>&gt;</span> <span class=n>asList</span> <span class=o>=</span> <span class=n>mapper</span><span class=o>.</span><span class=na>readValue</span><span class=o>(</span><span class=n>jsonArray</span><span class=o>,</span> <span class=n>List</span><span class=o>.</span><span class=na>class</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>assertThat</span><span class=o>((</span><span class=n>Object</span><span class=o>)</span> <span class=n>asList</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=mi>0</span><span class=o>),</span> <span class=n>instanceOf</span><span class=o>(</span><span class=n>LinkedHashMap</span><span class=o>.</span><span class=na>class</span><span class=o>));</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>有两种方法可以帮助Jackson理解正确的类型信息——我们可以为此使用库提供的TypeReference：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Test</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>givenJsonArray_whenDeserializingAsListWithTypeReferenceHelp_thenCorrect</span><span class=o>()</span> 
</span></span><span class=line><span class=cl>  <span class=kd>throws</span> <span class=n>JsonParseException</span><span class=o>,</span> <span class=n>JsonMappingException</span><span class=o>,</span> <span class=n>IOException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>    <span class=n>ObjectMapper</span> <span class=n>mapper</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectMapper</span><span class=o>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>List</span><span class=o>&lt;</span><span class=n>MyDto</span><span class=o>&gt;</span> <span class=n>listOfDtos</span> <span class=o>=</span> <span class=n>Lists</span><span class=o>.</span><span class=na>newArrayList</span><span class=o>(</span>
</span></span><span class=line><span class=cl>      <span class=k>new</span> <span class=n>MyDto</span><span class=o>(</span><span class=s>&#34;a&#34;</span><span class=o>,</span> <span class=mi>1</span><span class=o>,</span> <span class=kc>true</span><span class=o>),</span> <span class=k>new</span> <span class=n>MyDto</span><span class=o>(</span><span class=s>&#34;bc&#34;</span><span class=o>,</span> <span class=mi>3</span><span class=o>,</span> <span class=kc>false</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>jsonArray</span> <span class=o>=</span> <span class=n>mapper</span><span class=o>.</span><span class=na>writeValueAsString</span><span class=o>(</span><span class=n>listOfDtos</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>List</span><span class=o>&lt;</span><span class=n>MyDto</span><span class=o>&gt;</span> <span class=n>asList</span> <span class=o>=</span> <span class=n>mapper</span><span class=o>.</span><span class=na>readValue</span><span class=o>(</span>
</span></span><span class=line><span class=cl>      <span class=n>jsonArray</span><span class=o>,</span> <span class=k>new</span> <span class=n>TypeReference</span><span class=o>&lt;</span><span class=n>List</span><span class=o>&lt;</span><span class=n>MyDto</span><span class=o>&gt;&gt;()</span> <span class=o>{</span> <span class=o>});</span>
</span></span><span class=line><span class=cl>    <span class=n>assertThat</span><span class=o>(</span><span class=n>asList</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=mi>0</span><span class=o>),</span> <span class=n>instanceOf</span><span class=o>(</span><span class=n>MyDto</span><span class=o>.</span><span class=na>class</span><span class=o>));</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>或者我们可以使用接受JavaType的重载readValue方法：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Test</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>givenJsonArray_whenDeserializingAsListWithJavaTypeHelp_thenCorrect</span><span class=o>()</span> 
</span></span><span class=line><span class=cl>  <span class=kd>throws</span> <span class=n>JsonParseException</span><span class=o>,</span> <span class=n>JsonMappingException</span><span class=o>,</span> <span class=n>IOException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>ObjectMapper</span> <span class=n>mapper</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ObjectMapper</span><span class=o>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>List</span><span class=o>&lt;</span><span class=n>MyDto</span><span class=o>&gt;</span> <span class=n>listOfDtos</span> <span class=o>=</span> <span class=n>Lists</span><span class=o>.</span><span class=na>newArrayList</span><span class=o>(</span>
</span></span><span class=line><span class=cl>      <span class=k>new</span> <span class=n>MyDto</span><span class=o>(</span><span class=s>&#34;a&#34;</span><span class=o>,</span> <span class=mi>1</span><span class=o>,</span> <span class=kc>true</span><span class=o>),</span> <span class=k>new</span> <span class=n>MyDto</span><span class=o>(</span><span class=s>&#34;bc&#34;</span><span class=o>,</span> <span class=mi>3</span><span class=o>,</span> <span class=kc>false</span><span class=o>));</span>
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>jsonArray</span> <span class=o>=</span> <span class=n>mapper</span><span class=o>.</span><span class=na>writeValueAsString</span><span class=o>(</span><span class=n>listOfDtos</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>CollectionType</span> <span class=n>javaType</span> <span class=o>=</span> <span class=n>mapper</span><span class=o>.</span><span class=na>getTypeFactory</span><span class=o>()</span>
</span></span><span class=line><span class=cl>      <span class=o>.</span><span class=na>constructCollectionType</span><span class=o>(</span><span class=n>List</span><span class=o>.</span><span class=na>class</span><span class=o>,</span> <span class=n>MyDto</span><span class=o>.</span><span class=na>class</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>List</span><span class=o>&lt;</span><span class=n>MyDto</span><span class=o>&gt;</span> <span class=n>asList</span> <span class=o>=</span> <span class=n>mapper</span><span class=o>.</span><span class=na>readValue</span><span class=o>(</span><span class=n>jsonArray</span><span class=o>,</span> <span class=n>javaType</span><span class=o>);</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl>    <span class=n>assertThat</span><span class=o>(</span><span class=n>asList</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=mi>0</span><span class=o>),</span> <span class=n>instanceOf</span><span class=o>(</span><span class=n>MyDto</span><span class=o>.</span><span class=na>class</span><span class=o>));</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>最后一个注意事项是，MyDto类需要有无参数的默认构造函数——如果没有，Jackson将无法实例化它：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-latex data-lang=latex><span class=line><span class=cl>com.fasterxml.jackson.databind.JsonMappingException: 
</span></span><span class=line><span class=cl>No suitable constructor found for type [simple type, class org.baeldung.jackson.ignore.MyDto]: 
</span></span><span class=line><span class=cl>can not instantiate from JSON object (need to add/enable type information?)
</span></span></code></pre></div><h2 id=如何比较两个json对象是否相等 data-numberify>如何比较两个json对象是否相等？<a class="anchor ms-1" href=#如何比较两个json对象是否相等></a></h2><p>使用 <a href=https://static.javadoc.io/com.fasterxml.jackson.core/jackson-databind/2.9.8/com/fasterxml/jackson/databind/JsonNode.html#equals-java.lang.Object- target=_blank rel="noopener noreferrer">JsonNode.equals<i class="fas fa-external-link-square-alt ms-1"></i></a> 方法执行完全（深度）比较。</p><p>假设我们有一个JSON字符串定义为s1变量：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;employee&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;id&#34;</span><span class=p>:</span> <span class=s2>&#34;1212&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;fullName&#34;</span><span class=p>:</span> <span class=s2>&#34;John Miles&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;age&#34;</span><span class=p>:</span> <span class=mi>34</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>我们有另一个JSON字符串定义为s2变量：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>   
</span></span><span class=line><span class=cl>    <span class=nt>&#34;employee&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;id&#34;</span><span class=p>:</span> <span class=s2>&#34;1212&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;age&#34;</span><span class=p>:</span> <span class=mi>34</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;fullName&#34;</span><span class=p>:</span> <span class=s2>&#34;John Miles&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>让我们将输入JSON读取为JsonNode，并进行比较：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>assertEquals</span><span class=o>(</span><span class=n>mapper</span><span class=o>.</span><span class=na>readTree</span><span class=o>(</span><span class=n>s1</span><span class=o>),</span> <span class=n>mapper</span><span class=o>.</span><span class=na>readTree</span><span class=o>(</span><span class=n>s2</span><span class=o>));</span>
</span></span></code></pre></div><p>需要注意的是，即使输入JSON变量s1和s2中属性的顺序不同，equals（）方法也会忽略顺序并将它们视为相等。</p><h2 id=如何对map进行序列化和反序列化 data-numberify>如何对Map进行序列化和反序列化<a class="anchor ms-1" href=#如何对map进行序列化和反序列化></a></h2><p>序列化将Java对象转换为字节流，可以根据需要进行持久化或共享。Java Map是将键对象映射到值对象的集合，通常是最不直观的序列化对象。</p><h3 id=mapstring-string-序列化 data-numberify>Map<string, string> 序列化<a class="anchor ms-1" href=#mapstring-string-序列化></a></h3><p>对于一个简单的例子，让我们创建一个Map＜String，String＞并将其序列化为JSON：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=err>Map&lt;String,</span> <span class=err>String&gt;</span> <span class=err>map</span> <span class=err>=</span> <span class=err>new</span> <span class=err>HashMap&lt;&gt;();</span>
</span></span><span class=line><span class=cl><span class=err>map.put(</span><span class=s2>&#34;key&#34;</span><span class=err>,</span> <span class=s2>&#34;value&#34;</span><span class=err>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>ObjectMapper</span> <span class=err>mapper</span> <span class=err>=</span> <span class=err>new</span> <span class=err>ObjectMapper();</span>
</span></span><span class=line><span class=cl><span class=err>String</span> <span class=err>jsonResult</span> <span class=err>=</span> <span class=err>mapper.writerWithDefaultPrettyPrinter()</span>
</span></span><span class=line><span class=cl>  <span class=err>.writeValueAsString(map);</span>
</span></span></code></pre></div><p>ObjectMapper是Jackson的序列化映射器。它允许我们序列化我们的Map，并使用String中的toString方法将其写成一个打印精美的JSON字符串：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;key&#34;</span> <span class=p>:</span> <span class=s2>&#34;value&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=mapobject-string-序列化 data-numberify>Map<object, string> 序列化<a class="anchor ms-1" href=#mapobject-string-序列化></a></h3></div></div></div><div class=card-footer><div class="post-navs d-flex justify-content-evenly"><div class="post-nav post-prev"><i class="fas fa-fw fa-chevron-down post-prev-icon me-1" data-fa-transform=rotate-90></i>
<a href=/myblog/blog/2022/12/spring%E5%AE%B9%E5%99%A8/>Spring容器</a></div><div class="post-nav post-next"><a href=/myblog/blog/2022/12/spring-boot-core/>Spring-Boot-Core</a>
<i class="fas fa-fw fa-chevron-down post-next-icon ms-1" data-fa-transform=rotate-270></i></div></div></div></article><section class="related-posts row card component"><div class=card-header><h2 class="card-title fs-4 my-2 text-surface">相关文章</h2></div><div class="card-body slide px-1"><div class="slide-inner row gx-0"><div class="col-12 col-md-6 col-lg-4 me-2"><div class="post-card card card-body p-0 border-0 surface"><div class="post-card-default-img card-img-top d-flex align-items-center justify-content-center bg-body-secondary mb-1">NO IMAGE</div><a class=post-title href=/myblog/blog/2022/12/spring%E5%AE%B9%E5%99%A8/>Spring容器</a><div class="post-meta mb-0">2022年12月2日</div></div></div><div class="col-12 col-md-6 col-lg-4 me-2"><div class="post-card card card-body p-0 border-0 surface"><div class="post-card-default-img card-img-top d-flex align-items-center justify-content-center bg-body-secondary mb-1">NO IMAGE</div><a class=post-title href=/myblog/blog/2022/12/spring-batch/>Spring-Batch</a><div class="post-meta mb-0">2022年12月2日</div></div></div><div class="col-12 col-md-6 col-lg-4 me-2"><div class="post-card card card-body p-0 border-0 surface"><div class="post-card-default-img card-img-top d-flex align-items-center justify-content-center bg-body-secondary mb-1">NO IMAGE</div><a class=post-title href=/myblog/blog/2022/11/jdk%E6%96%B0%E7%89%B9%E6%80%A7/>Jdk新特性</a><div class="post-meta mb-0">2022年11月27日</div></div></div><div class="col-12 col-md-6 col-lg-4 me-2"><div class="post-card card card-body p-0 border-0 surface"><div class="post-card-default-img card-img-top d-flex align-items-center justify-content-center bg-body-secondary mb-1">NO IMAGE</div><a class=post-title href=/myblog/blog/2022/11/graphql-spring/>Graphql-Spring</a><div class="post-meta mb-0">2022年11月27日</div></div></div><div class="col-12 col-md-6 col-lg-4 me-2"><div class="post-card card card-body p-0 border-0 surface"><div class="post-card-default-img card-img-top d-flex align-items-center justify-content-center bg-body-secondary mb-1">NO IMAGE</div><a class=post-title href=/myblog/blog/1/01/gradle-%E4%BE%9D%E8%B5%96%E8%A7%A3%E6%9E%90/>Gradle 依赖解析</a><div class="post-meta mb-0">1年1月1日</div></div></div></div><button class=slide-control-left>
<i class="fas fa-2x fa-chevron-circle-down" data-fa-transform=rotate-90></i>
<span class=visually-hidden>Left</span></button>
<button class=slide-control-right>
<i class="fas fa-2x fa-chevron-circle-down" data-fa-transform=rotate-270></i>
<span class=visually-hidden>Right</span></button></div></section><div class="card component row post-comments" id=post-comments><div class=card-header><h2 class="card-title my-2 fs-4 text-surface">评论</h2></div><div class=card-body></div></div></div></div><aside class="col-xxl-4 sidebar d-flex"><div class="container d-flex flex-column"><div class="accordion profile"><div class="accordion-item card row text-center component"><div class="accordion-header card-header border-0" id=profile-header><a class="accordion-button d-lg-none mb-2 shadow-none p-0 bg-transparent text-surface collapsed" role=button data-bs-toggle=collapse href=#profile aria-expanded=false aria-controls=profile>Profile</a></div><div class="card-body collapse accordion-collapse accordion-body d-lg-block" id=profile aria-labelledby=profile-header><div class="col-12 d-flex align-items-center justify-content-center"><picture><img class="profile-avatar rounded-circle" alt=小胖子 src=https://banrenshan.github.io/myblog/images/profile.webp loading=lazy data-viewer-invisible width=400 height=400></picture></div><div class="col-12 profile-meta"><div class="profile-name fw-fold fs-lg">小胖子</div><div class=profile-bio>每天一点点</div></div></div></div></div><div class="accordion taxonomies-toggle"><div class="row card component accordion-item"><div class="accordion-header card-header border-0"><a class="accordion-button d-lg-none mb-1 shadow-none p-0 bg-transparent collapsed" role=button data-bs-toggle=collapse href=#taxonomies-toggle aria-expanded=false aria-controls=taxonomies-toggle>Taxonomies</a></div><div class="card-body collapse accordion-collapse accordion-body d-lg-block" id=taxonomies-toggle><ul class="nav nav-pills nav-fill" role=tablist><li class=nav-item role=presentation><button class="nav-link active" id=taxonomyCategoriesTab data-bs-toggle=tab data-bs-target=#taxonomyCategories type=button role=tab aria-controls=taxonomyCategories aria-selected=true>
分类</button></li><li class=nav-item role=presentation><button class=nav-link id=taxonomyTagsTab data-bs-toggle=tab data-bs-target=#taxonomyTags type=button role=tab aria-controls=taxonomyTags aria-selected=true>
标签</button></li><li class=nav-item role=presentation><button class=nav-link id=taxonomyArchivesTab data-bs-toggle=tab data-bs-target=#taxonomyArchives type=button role=tab aria-controls=taxonomyArchives aria-selected=true>
归档</button></li></ul><div class="tab-content mt-3"><div class="tab-pane active" id=taxonomyCategories role=tabpanel aria-labelledby=taxonomyCategoriesTab tabindex=0><a href=/myblog/categories/%E6%8A%80%E6%9C%AF/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-category me-2 mb-2" title=技术>技术
<span class="badge badge-sm text-secondary bg-white ms-1">24</span></a>
<a href=/myblog/categories/linux/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-category me-2 mb-2" title=linux>linux
<span class="badge badge-sm text-secondary bg-white ms-1">9</span></a>
<a href=/myblog/categories/java/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-category me-2 mb-2" title=java>java
<span class="badge badge-sm text-secondary bg-white ms-1">8</span></a>
<a href=/myblog/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-category me-2 mb-2" title=操作系统>操作系统
<span class="badge badge-sm text-secondary bg-white ms-1">8</span></a>
<a href=/myblog/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-category me-2 mb-2" title=中间件>中间件
<span class="badge badge-sm text-secondary bg-white ms-1">7</span></a>
<a href=/myblog/categories/spring/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-category me-2 mb-2" title=spring>spring
<span class="badge badge-sm text-secondary bg-white ms-1">3</span></a>
<a href=/myblog/categories/docker/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-category me-2 mb-2" title=docker>docker
<span class="badge badge-sm text-secondary bg-white ms-1">1</span></a>
<a href=/myblog/categories/spring-boot/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-category me-2 mb-2" title=spring-boot>spring-boot
<span class="badge badge-sm text-secondary bg-white ms-1">1</span></a>
<a href=/myblog/categories/spring-cloud/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-category me-2 mb-2" title=spring-cloud>spring-cloud
<span class="badge badge-sm text-secondary bg-white ms-1">1</span></a>
<a href=/myblog/categories/unbutu/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-category me-2 mb-2" title=Unbutu>Unbutu
<span class="badge badge-sm text-secondary bg-white ms-1">1</span></a>
<a href=https://banrenshan.github.io/myblog/categories class="btn btn-sm btn-secondary post-taxonomy ps-3 post-category me-2 mb-2" title=全部>全部
<span class="badge badge-sm text-secondary bg-white ms-1">13</span></a></div><div class=tab-pane id=taxonomyTags role=tabpanel aria-labelledby=taxonomyTagsTab tabindex=0><a href=/myblog/tags/java/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title=java>java
<span class="badge badge-sm text-secondary bg-white ms-1">31</span></a>
<a href=/myblog/tags/linux/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title=linux>linux
<span class="badge badge-sm text-secondary bg-white ms-1">8</span></a>
<a href=/myblog/tags/%E7%9B%91%E6%8E%A7/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title=监控>监控
<span class="badge badge-sm text-secondary bg-white ms-1">4</span></a>
<a href=/myblog/tags/gradle/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title=gradle>gradle
<span class="badge badge-sm text-secondary bg-white ms-1">3</span></a>
<a href=/myblog/tags/graphql/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title=graphql>graphql
<span class="badge badge-sm text-secondary bg-white ms-1">3</span></a>
<a href=/myblog/tags/spring/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title=spring>spring
<span class="badge badge-sm text-secondary bg-white ms-1">3</span></a>
<a href=/myblog/tags/shell/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title=shell>shell
<span class="badge badge-sm text-secondary bg-white ms-1">2</span></a>
<a href=/myblog/tags/docker/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title=docker>docker
<span class="badge badge-sm text-secondary bg-white ms-1">1</span></a>
<a href=/myblog/tags/filebeat/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title=filebeat>filebeat
<span class="badge badge-sm text-secondary bg-white ms-1">1</span></a>
<a href=/myblog/tags/grafana/ class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title=grafana>grafana
<span class="badge badge-sm text-secondary bg-white ms-1">1</span></a>
<a href=https://banrenshan.github.io/myblog/tags class="btn btn-sm btn-secondary post-taxonomy ps-3 post-tag me-2 mb-2" title=全部>全部
<span class="badge badge-sm text-secondary bg-white ms-1">22</span></a></div><div class=tab-pane id=taxonomyArchives role=tabpanel aria-labelledby=taxonomyArchivesTab tabindex=0><a href class="btn btn-sm btn-secondary post-taxonomy ps-3 me-2 mb-2" title=2022>2022 <span class="badge badge-sm text-secondary bg-white ms-1">48</span></a>
<a href class="btn btn-sm btn-secondary post-taxonomy ps-3 me-2 mb-2" title=0001>0001 <span class="badge badge-sm text-secondary bg-white ms-1">5</span></a></div></div></div></div></div><div class="accordion posts-toggle"><div class="row card component accordion-item"><div class="accordion-header card-header border-0"><a class="accordion-button d-lg-none mb-1 shadow-none p-0 bg-transparent collapsed" role=button data-bs-toggle=collapse href=#posts-toggle aria-expanded=false aria-controls=posts-toggle>文章</a></div><div class="card-body collapse accordion-collapse accordion-body d-lg-block" id=posts-toggle><ul class="nav nav-pills nav-fill" role=tablist><li class=nav-item role=presentation><button class="nav-link active" id=recent-posts-tab data-bs-toggle=tab data-bs-target=#recent-posts type=button role=tab aria-controls=recent-posts aria-selected=true>
最近文章</button></li></ul><div class="tab-content mt-3"><div class="tab-pane active" id=recent-posts role=tabpanel aria-labelledby=recent-posts-tab tabindex=0><ul class="post-list list-unstyled ms-1"><li class=mb-2><div class=d-flex><div class="flex-grow-1 d-flex flex-column h-auto justify-content-center"><a class=post-title href=/myblog/blog/2022/12/grafana/>Grafana</a><div class="post-meta mt-2"><span class=post-date>2022年12月10日</span></div></div></div></li><li class=mb-2><div class=d-flex><div class="flex-grow-1 d-flex flex-column h-auto justify-content-center"><a class=post-title href=/myblog/blog/2022/12/gradle-basic/>Gradle-Basic</a><div class="post-meta mt-2"><span class=post-date>2022年12月2日</span></div></div></div></li><li class=mb-2><div class=d-flex><div class="flex-grow-1 d-flex flex-column h-auto justify-content-center"><a class=post-title href=/myblog/blog/2022/12/zero-copy/>Zero-Copy</a><div class="post-meta mt-2"><span class=post-date>2022年12月2日</span></div></div></div></li><li class=mb-2><div class=d-flex><div class="flex-grow-1 d-flex flex-column h-auto justify-content-center"><a class=post-title href=/myblog/blog/2022/12/java-lock/>Java-Lock</a><div class="post-meta mt-2"><span class=post-date>2022年12月2日</span></div></div></div></li><li class=mb-2><div class=d-flex><div class="flex-grow-1 d-flex flex-column h-auto justify-content-center"><a class=post-title href=/myblog/blog/2022/12/java-log/>Java-Log</a><div class="post-meta mt-2"><span class=post-date>2022年12月2日</span></div></div></div></li></ul></div></div></div></div></div><div class="accordion post-toc d-none d-lg-block"><div class="accordion-item row mb-4 card component" id=postTOC><div class="card-header accordion-header"><h2 class="card-title fs-4 my-2 text-surface d-none d-lg-block">目录</h2><a class="accordion-button d-lg-none mb-1 collapsed shadow-none p-0 bg-transparent" role=button data-bs-toggle=collapse href=#post-toc aria-expanded=false aria-controls=post-toc>目录</a></div><div class="card-body collapse accordion-collapse accordion-body d-lg-block" id=post-toc><nav id=TableOfContents><ul><li><a href=#基本使用>基本使用</a></li><li><a href=#jsonnodejson的表示对象>JsonNode：json的表示对象</a></li><li><a href=#转换成集合类型>转换成集合类型</a></li></ul><ul><li><a href=#常规注解>常规注解</a><ul><li><a href=#jsonproperty><em><strong>@JsonProperty</strong></em></a></li><li><a href=#jsonformat><em><strong>@JsonFormat</strong></em></a></li><li><a href=#jsonunwrapped><em><strong>@JsonUnwrapped</strong></em></a></li><li><a href=#jsonview><em><strong>@JsonView</strong></em></a></li><li><a href=#jsonmanagedreference-jsonbackreference><em><strong>@JsonManagedReference, @JsonBackReference</strong></em></a></li><li><a href=#jsonidentityinfo><em><strong>@JsonIdentityInfo</strong></em></a></li><li><a href=#jsonfilter><em><strong>@JsonFilter</strong></em></a></li></ul></li><li><a href=#序列化>序列化</a><ul><li><a href=#jsonanygetter><em><strong>@JsonAnyGetter</strong></em></a></li><li><a href=#jsongetter><em><strong>@JsonGetter</strong></em></a></li><li><a href=#jsonpropertyorder><em><strong>@JsonPropertyOrder</strong></em></a></li><li><a href=#jsonrawvalue><em><strong>@JsonRawValue</strong></em></a></li><li><a href=#jsonvalue><em><strong>@JsonValue</strong></em></a></li><li><a href=#jsonrootname><em><strong>@JsonRootName</strong></em></a></li><li><a href=#jsonserialize><em><strong>@JsonSerialize</strong></em></a></li></ul></li><li><a href=#反序列化>反序列化</a><ul><li><a href=#jsoncreator><em><strong>@JsonCreator</strong></em></a></li><li><a href=#jacksoninject><em><strong>@JacksonInject</strong></em></a></li><li><a href=#jsonanysetter><em><strong>@JsonAnySetter</strong></em></a></li><li><a href=#jsonsetter><em><strong>@JsonSetter</strong></em></a></li><li><a href=#jsondeserialize><em><strong>@JsonDeserialize</strong></em></a></li><li><a href=#jsonalias><em>@JsonAlias</em></a></li></ul></li><li><a href=#包含>包含</a><ul><li><a href=#jsonignoreproperties><em><strong>@JsonIgnoreProperties</strong></em></a></li><li><a href=#jsonignore><em><strong>@JsonIgnore</strong></em></a></li><li><a href=#jsonignoretype><em><strong>@JsonIgnoreType</strong></em></a></li><li><a href=#jsoninclude><em><strong>@JsonInclude</strong></em></a></li><li><a href=#jsonautodetect><em><strong>@JsonAutoDetect</strong></em></a></li></ul></li><li><a href=#多态>多态</a></li><li><a href=#自定义注解>自定义注解</a></li><li><a href=#混入>混入</a></li><li><a href=#其他>其他</a><ul><li><a href=#jsonidentityreference>@JsonIdentityReference</a></li><li><a href=#jsonappend>@JsonAppend</a></li><li><a href=#jsonnaming>@JsonNaming</a></li><li><a href=#jsonpropertydescription>@JsonPropertyDescription</a></li><li><a href=#jsonpojobuilder>@JsonPOJOBuilder</a></li><li><a href=#jsontypeid>@JsonTypeId</a></li><li><a href=#jsontypeidresolver>@JsonTypeIdResolver</a></li></ul></li></ul><ul><li><a href=#编组时如何忽略属性>编组时如何忽略属性？</a></li><li><a href=#jackson处理optional-字段>jackson处理Optional 字段</a></li><li><a href=#反序列化集合类型>反序列化集合类型？</a><ul><li><a href=#转换成数组>转换成数组</a></li><li><a href=#转换成集合>转换成集合</a></li></ul></li><li><a href=#如何比较两个json对象是否相等>如何比较两个json对象是否相等？</a></li><li><a href=#如何对map进行序列化和反序列化>如何对Map进行序列化和反序列化</a><ul><li><a href=#mapstring-string-序列化><em><strong>Map&lt;String, String></strong></em> <strong>序列化</strong></a></li><li><a href=#mapobject-string-序列化><em><strong>Map&lt;Object, String></strong></em> <strong>序列化</strong></a></li></ul></li></ul></nav></div></div></div></div></aside></div></main><footer class="footer mt-auto py-3 text-center container"></footer><script data-precache src=/myblog/assets/main/bundle.min.4976817c50e9fbebc65d5da4994ce4fe52de9ef0821503aee57a131f470d190f.js integrity="sha256-SXaBfFDp++vGXV2kmUzk/lLenvCCFQOu5XoTH0cNGQ8=" crossorigin=anonymous async></script><script data-precache src=/myblog/assets/icons/bundle.min.4f30d5267a9f2f9d45ed93969d45ec626100a969a8b91f71f753315a261e9034.js integrity="sha256-TzDVJnqfL51F7ZOWnUXsYmEAqWmouR9x91MxWiYekDQ=" crossorigin=anonymous defer></script>
<script data-precache src=/myblog/assets/viewer/bundle.min.0a0d0099935beee41b7a7bf4543cd55e793e5f830a571b0794ef8c3602c5823c.js integrity="sha256-Cg0AmZNb7uQbenv0VDzVXnk+X4MKVxsHlO+MNgLFgjw=" crossorigin=anonymous defer></script>
<script src=/myblog/js/sw-register.js defer></script></body></html>